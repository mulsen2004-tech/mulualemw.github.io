<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECLS SAFETY PORTAL - Ethiopian Airlines Cargo</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        /* Login Page Styles */
        .login-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
        }

        .login-title {
            font-size: 48px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            text-align: center;
        }

        .login-subtitle {
            font-size: 24px;
            margin-bottom: 40px;
            opacity: 0.9;
            text-align: center;
        }

        .login-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .login-logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-logo i {
            font-size: 60px;
            color: #fff;
            margin-bottom: 15px;
        }

        /* Home Page Styles */
        .home-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
        }

        .home-title {
            font-size: 48px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            text-align: center;
        }

        .home-subtitle {
            font-size: 24px;
            margin-bottom: 40px;
            opacity: 0.9;
            text-align: center;
        }

        .pillars-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            max-width: 1000px;
            width: 100%;
            margin-top: 30px;
        }

        .pillar-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .pillar-box:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .pillar-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .pillar-subitems {
            list-style-type: none;
            padding: 0;
            margin-top: 15px;
        }

        .pillar-subitems li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pillar-subitems li:hover {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            padding-left: 10px;
        }

        .pillar-subitems li:last-child {
            border-bottom: none;
        }

        /* Main Application Styles */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            display: none;
        }

        .header {
            background: linear-gradient(90deg, #1f77b4, #2e86ab);
            color: white;
            padding: 25px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-titles h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .header-titles p {
            font-size: 16px;
            opacity: 0.9;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-details {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
        }

        .nav {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 2px solid #e9ecef;
            overflow-x: auto;
        }

        .nav-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            min-width: max-content;
        }

        .nav-btn {
            background: white;
            border: 2px solid #1f77b4;
            color: #1f77b4;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .nav-btn:hover, .nav-btn.active {
            background: #1f77b4;
            color: white;
        }

        .content {
            padding: 25px;
            min-height: 500px;
            overflow-x: auto;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .metric-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .table-container {
            max-height: 600px;
            overflow: auto;
            margin: 20px 0;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        .table th, .table td {
            padding: 8px;
            text-align: left;
            border: 1px solid #e0e0e0;
            vertical-align: top;
        }

        .table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #1f77b4;
            position: sticky;
            top: 0;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-progress {
            background: #cce7ff;
            color: #004085;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .risk-high {
            background: #f8d7da;
            color: #721c24;
            padding: 5px 8px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
        }

        .risk-medium {
            background: #fff3cd;
            color: #856404;
            padding: 5px 8px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
        }

        .risk-low {
            background: #d4edda;
            color: #155724;
            padding: 5px 8px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 14px;
        }

        .form-control:focus {
            border-color: #1f77b4;
            outline: none;
        }

        .btn {
            background: #1f77b4;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: background 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            background: #155a8a;
        }

        .btn-success {
            background: #28a745;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background: #138496;
        }

        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #28a745, #20c997);
            height: 100%;
            transition: width 0.3s ease;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .upload-dashboard-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #28a745;
        }

        .upload-instructions {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .upload-instructions h4 {
            color: #1f77b4;
            margin-bottom: 10px;
        }

        .upload-instructions ul {
            margin-left: 20px;
        }

        .upload-instructions li {
            margin-bottom: 5px;
        }

        .dashboard-upload-form {
            display: flex;
            gap: 15px;
            align-items: flex-end;
            flex-wrap: wrap;
        }

        .dashboard-upload-form .form-group {
            margin-bottom: 0;
        }

        .dashboard-preview {
            margin-top: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            padding: 15px;
            background: white;
        }

        .dashboard-preview h4 {
            color: #1f77b4;
            margin-bottom: 10px;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
            max-height: 300px;
            overflow: auto;
            display: block;
        }

        .preview-table th, .preview-table td {
            padding: 4px;
            border: 1px solid #e0e0e0;
            text-align: left;
        }

        .preview-table th {
            background: #f8f9fa;
            font-weight: bold;
        }

        .dashboard-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .full-preview-container {
            max-height: 500px;
            overflow: auto;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            margin-top: 10px;
        }

        .hazard-link {
            display: inline-block;
            background: #dc3545;
            color: white;
            padding: 12px 25px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            margin: 10px 0;
            transition: background 0.3s ease;
        }

        .hazard-link:hover {
            background: #c82333;
        }

        .search-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #1f77b4;
        }

        .search-form {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-form .form-group {
            margin-bottom: 0;
        }

        .indicator-key {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }

        .indicator-key h4 {
            color: #1f77b4;
            margin-bottom: 10px;
        }

        .indicator-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 10px;
        }

        .indicator-item {
            padding: 8px;
            border-bottom: 1px solid #e0e0e0;
        }

        .indicator-name {
            font-weight: bold;
            color: #1f77b4;
        }

        .chart-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }

        .chart-card {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            color: #1f77b4;
        }

        .performance-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
        }

        .performance-bar {
            flex: 1;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .performance-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            transition: width 0.5s ease;
        }

        .performance-value {
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }

        .performance-excellent {
            background: linear-gradient(90deg, #28a745, #20c997);
        }

        .performance-good {
            background: linear-gradient(90deg, #ffc107, #fd7e14);
        }

        .performance-poor {
            background: linear-gradient(90deg, #dc3545, #e83e8c);
        }

        .dashboard-performance {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-performance-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #1f77b4;
        }

        .dashboard-performance-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #1f77b4;
            text-align: center;
        }

        /* Document Upload Styles */
        .document-upload-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #17a2b8;
        }

        .document-upload-form {
            display: flex;
            gap: 15px;
            align-items: flex-end;
            flex-wrap: wrap;
        }

        .document-upload-form .form-group {
            margin-bottom: 0;
        }

        .uploaded-documents {
            margin-top: 20px;
        }

        .document-list {
            list-style: none;
            padding: 0;
        }

        .document-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #e0e0e0;
        }

        .document-item:last-child {
            border-bottom: none;
        }

        .document-actions {
            display: flex;
            gap: 10px;
        }

        /* Status Indicators */
        .status-red {
            background: #f8d7da;
            color: #721c24;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-green {
            background: #d4edda;
            color: #155724;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-yellow {
            background: #fff3cd;
            color: #856404;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        /* Audit Plan Table */
        .audit-plan-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .audit-plan-table th, .audit-plan-table td {
            border: 1px solid #e0e0e0;
            padding: 8px;
            text-align: center;
        }

        .audit-plan-table th {
            background: #f8f9fa;
            font-weight: bold;
        }

        .audit-plan-table .month-header {
            background: #1f77b4;
            color: white;
        }

        @media (max-width: 768px) {
            .pillars-container {
                grid-template-columns: 1fr;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
            
            .nav-btn {
                text-align: center;
            }
            
            .metric-grid {
                grid-template-columns: 1fr;
            }
            
            .table {
                font-size: 10px;
            }
            
            .table th, .table td {
                padding: 6px 3px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .dashboard-upload-form {
                flex-direction: column;
                gap: 10px;
            }
            
            .search-form {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <h1 class="login-title">ECLS SAFETY PORTAL</h1>
        <p class="login-subtitle">Ethiopian Airlines Cargo and Logistics Services Division</p>
        
        <div class="login-box">
            <div class="login-logo">
                <i class="fas fa-shield-alt"></i>
                <h2>Secure Sign In</h2>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label>Username:</label>
                    <input type="text" class="form-control" id="username" placeholder="Enter your username" required>
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" class="form-control" id="password" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="btn btn-success" style="width: 100%; margin-top: 20px;">
                    <i class="fas fa-sign-in-alt"></i> Sign In
                </button>
            </form>
            <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                <h4>Demo Credentials:</h4>
                <p><strong>Username:</strong> admin</p>
                <p><strong>Password:</strong> safety2024</p>
            </div>
        </div>
    </div>

    <!-- Home Page -->
    <div id="home-page" class="home-container" style="display: none;">
        <h1 class="home-title">ECLS SAFETY PORTAL</h1>
        <p class="home-subtitle">Ethiopian Airlines Cargo and Logistics Services Division Safety Portal</p>
        
        <div class="pillars-container">
            <!-- Pillar 1: Hazard and Occurrence Management -->
            <div class="pillar-box" onclick="showSection('hazard')">
                <div class="pillar-title">Hazard and Occurrence Management</div>
                <ul class="pillar-subitems">
                    <li onclick="event.stopPropagation(); showSection('risk')">Risk Assessment</li>
                    <li onclick="event.stopPropagation(); showSection('occurrences')">Occurrences</li>
                </ul>
            </div>
            
            <!-- Pillar 2: Safety Policy & Management Review -->
            <div class="pillar-box" onclick="showSection('safety-policy')">
                <div class="pillar-title">Safety Policy & Management Review</div>
                <ul class="pillar-subitems">
                    <li onclick="event.stopPropagation(); showSection('sag')">SAG</li>
                    <li onclick="event.stopPropagation(); showSection('monthly-dashboard')">Monthly SMS & QMS Dashboard</li>
                    <li onclick="event.stopPropagation(); showSection('moc')">MOC</li>
                </ul>
            </div>
            
            <!-- Pillar 3: Safety Assurance -->
            <div class="pillar-box" onclick="showSection('safety-assurance')">
                <div class="pillar-title">Safety Assurance</div>
                <ul class="pillar-subitems">
                    <li onclick="event.stopPropagation(); showSection('audits')">Audits</li>
                    <li onclick="event.stopPropagation(); showSection('spi')">SPI</li>
                    <li onclick="event.stopPropagation(); showSection('outstation')">Outstation</li>
                    <li onclick="event.stopPropagation(); showSection('isarps')">ISARPS List</li>
                    <li onclick="event.stopPropagation(); showSection('evidences')">Evidences</li>
                </ul>
            </div>
            
            <!-- Pillar 4: Safety Promotion -->
            <div class="pillar-box" onclick="showSection('safety')">
                <div class="pillar-title">Safety Promotion</div>
                <ul class="pillar-subitems">
                    <li onclick="event.stopPropagation(); showSection('safety')">Safety Activities</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="main-app" class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-titles">
                    <h1>ECLS SAFETY PORTAL</h1>
                    <p>Ethiopian Airlines Cargo and Logistics Services Division Safety Portal</p>
                </div>
                <div class="user-info">
                    <span class="user-details" id="userDisplay">Welcome, User</span>
                    <button class="btn btn-danger" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                    <button class="btn btn-info" onclick="showHomePage()">
                        <i class="fas fa-home"></i> Home
                    </button>
                </div>
            </div>
        </div>

        <div class="nav">
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </button>
                <button class="nav-btn" onclick="showSection('hazard')">
                    <i class="fas fa-exclamation-triangle"></i> Hazard Management
                </button>
                <button class="nav-btn" onclick="showSection('risk')">
                    <i class="fas fa-bullseye"></i> Risk Assessment
                </button>
                <button class="nav-btn" onclick="showSection('occurrences')">
                    <i class="fas fa-clipboard-list"></i> Occurrences
                </button>
                <button class="nav-btn" onclick="showSection('sag')">
                    <i class="fas fa-users"></i> SAG
                </button>
                <button class="nav-btn" onclick="showSection('monthly-dashboard')">
                    <i class="fas fa-chart-line"></i> Monthly Dashboard
                </button>
                <button class="nav-btn" onclick="showSection('moc')">
                    <i class="fas fa-exchange-alt"></i> MOC
                </button>
                <button class="nav-btn" onclick="showSection('audits')">
                    <i class="fas fa-search"></i> Audits
                </button>
                <button class="nav-btn" onclick="showSection('spi')">
                    <i class="fas fa-chart-bar"></i> SPI
                </button>
                <button class="nav-btn" onclick="showSection('outstation')">
                    <i class="fas fa-building"></i> Outstation
                </button>
                <button class="nav-btn" onclick="showSection('isarps')">
                    <i class="fas fa-list"></i> ISARPS List
                </button>
                <button class="nav-btn" onclick="showSection('evidences')">
                    <i class="fas fa-file-alt"></i> Evidences
                </button>
                <button class="nav-btn" onclick="showSection('safety')">
                    <i class="fas fa-bullhorn"></i> Safety Promotion
                </button>
            </div>
        </div>

        <div class="content">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <h2><i class="fas fa-tachometer-alt"></i> Dashboard Overview</h2>
                
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-number" id="totalIsarps">0</div>
                        <div class="metric-label">Total ISARPS</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-number" id="completedIsarps">0</div>
                        <div class="metric-label">Completed</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-number" id="progressIsarps">0</div>
                        <div class="metric-label">In Progress</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-number" id="pendingIsarps">0</div>
                        <div class="metric-label">Pending</div>
                    </div>
                </div>

                <div class="card">
                    <h3>Implementation Progress</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 0%"></div>
                    </div>
                    <p id="progressText">0% Complete (0 of 0 ISARPS implemented)</p>
                </div>

                <div class="chart-container">
                    <div class="chart-card">
                        <div class="chart-title">Occurrence Trend</div>
                        <canvas id="occurrenceChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">SPI Trend</div>
                        <canvas id="spiChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h3>Recent Activities</h3>
                    <ul id="recentActivities" style="list-style: none; padding: 0;">
                        <li style="padding: 10px; border-bottom: 1px solid #eee;">No activities yet</li>
                    </ul>
                </div>
            </div>

            <!-- Hazard Management Section -->
            <div id="hazard" class="section">
                <h2><i class="fas fa-exclamation-triangle"></i> Hazard Management</h2>
                <div class="card">
                    <h3>Safety Risk Management (SRM) System</h3>
                    <p>The Hazard Management module is integrated with our Safety Risk Management (SRM) system. Click the link below to access the full SRM application:</p>
                    <a href="https://etsms.ethiopianairlines.com/AccountManagement/Account/Login" class="hazard-link" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Access ET SRM System
                    </a>
                    <p>Alternatively, you can manage specific risk assessments and occurrences through the dedicated sections in this portal:</p>
                    <div class="action-buttons">
                        <button class="btn btn-info" onclick="showSection('risk')">
                            <i class="fas fa-bullseye"></i> Go to Risk Assessment
                        </button>
                        <button class="btn btn-info" onclick="showSection('occurrences')">
                            <i class="fas fa-clipboard-list"></i> Go to Occurrences
                        </button>
                    </div>
                </div>
            </div>

            <!-- Risk Assessment Section (Bowtie Format) -->
            <div id="risk" class="section">
                <h2><i class="fas fa-bullseye"></i> Risk Assessment - Bowtie Format</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="riskSearchForm">
                        <div class="form-group">
                            <label>Category:</label>
                            <select class="form-control" id="riskSearchCategory">
                                <option value="">All Categories</option>
                                <option value="Safety">Safety</option>
                                <option value="Security">Security</option>
                                <option value="Operational">Operational</option>
                                <option value="Financial">Financial</option>
                                <option value="Reputational">Reputational</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Risk Level:</label>
                            <select class="form-control" id="riskSearchLevel">
                                <option value="">All Levels</option>
                                <option value="Intolerable">Intolerable</option>
                                <option value="Moderate">Moderate</option>
                                <option value="Acceptable">Acceptable</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Date:</label>
                            <input type="date" class="form-control" id="riskSearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Date:</label>
                            <input type="date" class="form-control" id="riskSearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchRiskData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetRiskSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add Risk Assessment (Bowtie Format)</h3>
                    <form id="riskForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Risk ID:</label>
                                <input type="text" class="form-control" id="riskId" placeholder="e.g., RISK-2024-001" required>
                            </div>
                            <div class="form-group">
                                <label>Risk Category:</label>
                                <select class="form-control" id="riskCategory" required>
                                    <option value="Safety">Safety</option>
                                    <option value="Security">Security</option>
                                    <option value="Operational">Operational</option>
                                    <option value="Financial">Financial</option>
                                    <option value="Reputational">Reputational</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Hazard:</label>
                            <textarea class="form-control" id="riskHazard" rows="2" placeholder="Describe the hazard..." required></textarea>
                        </div>
                        <div class="form-group">
                            <label>Top Event:</label>
                            <textarea class="form-control" id="riskTopEvent" rows="2" placeholder="Describe the top event..." required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Threats:</label>
                                <textarea class="form-control" id="riskThreats" rows="3" placeholder="List potential threats..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Consequences:</label>
                                <textarea class="form-control" id="riskConsequences" rows="3" placeholder="List potential consequences..." required></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Preventive Barriers:</label>
                                <textarea class="form-control" id="riskPreventiveBarriers" rows="3" placeholder="List preventive barriers..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Recovery Barriers:</label>
                                <textarea class="form-control" id="riskRecoveryBarriers" rows="3" placeholder="List recovery barriers..." required></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Likelihood:</label>
                                <select class="form-control" id="riskLikelihood" required>
                                    <option value="Frequent">Frequent</option>
                                    <option value="Occasional">Occasional</option>
                                    <option value="Remote">Remote</option>
                                    <option value="Improbable">Improbable</option>
                                    <option value="Extremely Improbable">Extremely Improbable</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Severity:</label>
                                <select class="form-control" id="riskSeverity" required>
                                    <option value="Catastrophic">Catastrophic</option>
                                    <option value="Hazardous">Hazardous</option>
                                    <option value="Major">Major</option>
                                    <option value="Minor">Minor</option>
                                    <option value="Negligible">Negligible</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Risk Level:</label>
                                <select class="form-control" id="riskLevel" required>
                                    <option value="Intolerable">Intolerable</option>
                                    <option value="Moderate">Moderate</option>
                                    <option value="Acceptable">Acceptable</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Responsible Person:</label>
                                <input type="text" class="form-control" id="riskResponsible" placeholder="Enter name">
                            </div>
                            <div class="form-group">
                                <label>Due Date:</label>
                                <input type="date" class="form-control" id="riskDueDate">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Date Identified:</label>
                                <input type="date" class="form-control" id="riskDateIdentified" required>
                            </div>
                            <div class="form-group">
                                <label>Control Effectiveness:</label>
                                <select class="form-control" id="riskControlEffectiveness" required>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Risk Owner:</label>
                            <input type="text" class="form-control" id="riskOwner" placeholder="Enter risk owner name" required>
                        </div>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Risk
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>Upload Multiple Risk Assessments</h3>
                    <div class="upload-dashboard-section">
                        <div class="upload-instructions">
                            <h4>Instructions for Bulk Risk Data Upload</h4>
                            <ul>
                                <li>Prepare your data in Excel format with the required columns</li>
                                <li>Ensure data follows the correct format for each column</li>
                                <li>Select the Excel file using the file picker below</li>
                                <li>Click "Preview Data" to verify before uploading</li>
                            </ul>
                        </div>
                        <div class="dashboard-upload-form">
                            <div class="form-group">
                                <label>Select Excel File:</label>
                                <input type="file" class="form-control" id="riskUploadFile" accept=".xlsx, .xls">
                            </div>
                            <button class="btn btn-info" onclick="previewRiskData()">
                                <i class="fas fa-eye"></i> Preview Data
                            </button>
                            <button class="btn btn-success" onclick="uploadRiskData()">
                                <i class="fas fa-save"></i> Save Data
                            </button>
                        </div>
                        <div class="dashboard-preview" id="riskPreview" style="display: none;">
                            <h4>Preview of Risk Data</h4>
                            <div class="full-preview-container">
                                <table class="preview-table" id="riskPreviewTable">
                                    <thead>
                                        <tr>
                                            <th>Risk ID</th>
                                            <th>Category</th>
                                            <th>Hazard</th>
                                            <th>Top Event</th>
                                            <th>Threats</th>
                                            <th>Consequences</th>
                                            <th>Preventive Barriers</th>
                                            <th>Recovery Barriers</th>
                                            <th>Likelihood</th>
                                            <th>Severity</th>
                                            <th>Risk Level</th>
                                            <th>Responsible</th>
                                            <th>Due Date</th>
                                            <th>Date Identified</th>
                                            <th>Control Effectiveness</th>
                                            <th>Risk Owner</th>
                                        </tr>
                                    </thead>
                                    <tbody id="riskPreviewBody">
                                        <!-- Preview data will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="dashboard-actions">
                                <button class="btn btn-success" onclick="confirmRiskUpload()">
                                    <i class="fas fa-check"></i> Confirm Upload
                                </button>
                                <button class="btn btn-danger" onclick="cancelRiskUpload()">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Risk Assessment Matrix</h3>
                    <div class="table-container">
                        <table class="table" id="riskTable">
                            <thead>
                                <tr>
                                    <th>Risk ID</th>
                                    <th>Category</th>
                                    <th>Hazard</th>
                                    <th>Top Event</th>
                                    <th>Threats</th>
                                    <th>Consequences</th>
                                    <th>Preventive Barriers</th>
                                    <th>Recovery Barriers</th>
                                    <th>Likelihood</th>
                                    <th>Severity</th>
                                    <th>Risk Level</th>
                                    <th>Responsible</th>
                                    <th>Due Date</th>
                                    <th>Date Identified</th>
                                    <th>Control Effectiveness</th>
                                    <th>Risk Owner</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="riskTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Occurrences Section -->
            <div id="occurrences" class="section">
                <h2><i class="fas fa-clipboard-list"></i> Occurrence Reporting</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="occurrenceSearchForm">
                        <div class="form-group">
                            <label>Occurrence Type:</label>
                            <select class="form-control" id="occurrenceSearchType">
                                <option value="">All Types</option>
                                <option value="Ground Damage">Ground Damage</option>
                                <option value="DG Incident">DG Incident</option>
                                <option value="Loading Error">Loading Error</option>
                                <option value="Documentation Error">Documentation Error</option>
                                <option value="Security Breach">Security Breach</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Severity:</label>
                            <select class="form-control" id="occurrenceSearchSeverity">
                                <option value="">All Severities</option>
                                <option value="Low">Low</option>
                                <option value="Medium">Medium</option>
                                <option value="High">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Date:</label>
                            <input type="date" class="form-control" id="occurrenceSearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Date:</label>
                            <input type="date" class="form-control" id="occurrenceSearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchOccurrenceData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetOccurrenceSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add Occurrence</h3>
                    <form id="occurrenceForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Occurrence ID:</label>
                                <input type="text" class="form-control" id="occurrenceId" placeholder="e.g., OCC-2024-001" required>
                            </div>
                            <div class="form-group">
                                <label>Date & Time:</label>
                                <input type="datetime-local" class="form-control" id="occurrenceDateTime" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Occurrence Type:</label>
                                <select class="form-control" id="occurrenceType" required>
                                    <option value="Ground Damage">Ground Damage</option>
                                    <option value="DG Incident">DG Incident</option>
                                    <option value="Loading Error">Loading Error</option>
                                    <option value="Documentation Error">Documentation Error</option>
                                    <option value="Security Breach">Security Breach</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Severity:</label>
                                <select class="form-control" id="occurrenceSeverity" required>
                                    <option value="Low">Low</option>
                                    <option value="Medium">Medium</option>
                                    <option value="High">High</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Description:</label>
                            <textarea class="form-control" id="occurrenceDesc" rows="3" placeholder="Describe the occurrence..." required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Location:</label>
                                <input type="text" class="form-control" id="occurrenceLocation" placeholder="e.g., DEL Cargo Terminal" required>
                            </div>
                            <div class="form-group">
                                <label>Flight No:</label>
                                <input type="text" class="form-control" id="occurrenceFlight" placeholder="e.g., AI101">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Immediate Actions:</label>
                            <textarea class="form-control" id="occurrenceActions" rows="3" placeholder="Describe immediate actions taken..."></textarea>
                        </div>
                        
                        <!-- Document Upload for Evidence and Pictures -->
                        <div class="document-upload-section">
                            <h4>Upload Evidence and Pictures</h4>
                            <div class="document-upload-form">
                                <div class="form-group">
                                    <label>Select Files:</label>
                                    <input type="file" class="form-control" id="occurrenceFiles" multiple accept=".jpg,.jpeg,.png,.pdf,.doc,.docx">
                                </div>
                                <button type="button" class="btn btn-info" onclick="uploadOccurrenceDocuments()">
                                    <i class="fas fa-upload"></i> Upload Files
                                </button>
                            </div>
                            <div class="uploaded-documents">
                                <h5>Uploaded Documents:</h5>
                                <ul class="document-list" id="occurrenceDocumentList">
                                    <!-- Uploaded documents will be listed here -->
                                </ul>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Occurrence
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>Occurrence List</h3>
                    <div class="table-container">
                        <table class="table" id="occurrenceTable">
                            <thead>
                                <tr>
                                    <th>Occurrence ID</th>
                                    <th>Date & Time</th>
                                    <th>Type</th>
                                    <th>Severity</th>
                                    <th>Description</th>
                                    <th>Location</th>
                                    <th>Flight No</th>
                                    <th>Documents</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="occurrenceTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- SAG Section -->
            <div id="sag" class="section">
                <h2><i class="fas fa-users"></i> Safety Action Group (SAG)</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="sagSearchForm">
                        <div class="form-group">
                            <label>Meeting Type:</label>
                            <select class="form-control" id="sagSearchType">
                                <option value="">All Types</option>
                                <option value="Monthly">Monthly</option>
                                <option value="Quarterly">Quarterly</option>
                                <option value="Emergency">Emergency</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Date:</label>
                            <input type="date" class="form-control" id="sagSearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Date:</label>
                            <input type="date" class="form-control" id="sagSearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchSAGData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetSAGSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add SAG Meeting</h3>
                    <form id="sagForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Meeting ID:</label>
                                <input type="text" class="form-control" id="sagId" placeholder="e.g., SAG-2024-001" required>
                            </div>
                            <div class="form-group">
                                <label>Meeting Date:</label>
                                <input type="date" class="form-control" id="sagDate" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Meeting Type:</label>
                                <select class="form-control" id="sagType" required>
                                    <option value="Monthly">Monthly</option>
                                    <option value="Quarterly">Quarterly</option>
                                    <option value="Emergency">Emergency</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Chairperson:</label>
                                <input type="text" class="form-control" id="sagChairperson" placeholder="Enter chairperson name" required>
                            </div>
                        </div>
                        
                        <!-- Attendance List -->
                        <div class="form-group">
                            <label>Attendance List:</label>
                            <textarea class="form-control" id="sagAttendance" rows="3" placeholder="List attendees (one per line)..." required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Agenda:</label>
                            <textarea class="form-control" id="sagAgenda" rows="3" placeholder="Meeting agenda..." required></textarea>
                        </div>
                        <div class="form-group">
                            <label>Action Items:</label>
                            <textarea class="form-control" id="sagActions" rows="3" placeholder="Action items from meeting..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Next Meeting Date:</label>
                            <input type="date" class="form-control" id="sagNextDate">
                        </div>
                        
                        <!-- Document Upload for Minutes and Presentations -->
                        <div class="document-upload-section">
                            <h4>Upload Meeting Documents</h4>
                            <div class="document-upload-form">
                                <div class="form-group">
                                    <label>Select Files:</label>
                                    <input type="file" class="form-control" id="sagFiles" multiple accept=".pdf,.doc,.docx,.ppt,.pptx">
                                </div>
                                <button type="button" class="btn btn-info" onclick="uploadSAGDocuments()">
                                    <i class="fas fa-upload"></i> Upload Files
                                </button>
                            </div>
                            <div class="uploaded-documents">
                                <h5>Uploaded Documents:</h5>
                                <ul class="document-list" id="sagDocumentList">
                                    <!-- Uploaded documents will be listed here -->
                                </ul>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save SAG Meeting
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>SAG Meetings</h3>
                    <div class="table-container">
                        <table class="table" id="sagTable">
                            <thead>
                                <tr>
                                    <th>Meeting ID</th>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Chairperson</th>
                                    <th>Attendance</th>
                                    <th>Agenda</th>
                                    <th>Action Items</th>
                                    <th>Next Meeting</th>
                                    <th>Documents</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="sagTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Monthly SMS & QMS Dashboard Section -->
            <div id="monthly-dashboard" class="section">
                <h2><i class="fas fa-chart-line"></i> Monthly SMS & QMS Dashboard</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="dashboardSearchForm">
                        <div class="form-group">
                            <label>Dashboard Type:</label>
                            <select class="form-control" id="dashboardSearchType">
                                <option value="">All Types</option>
                                <option value="SMS">SMS Dashboard</option>
                                <option value="QMS">QMS Dashboard</option>
                                <option value="Combined">Combined Dashboard</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Month:</label>
                            <select class="form-control" id="dashboardSearchMonth">
                                <option value="">All Months</option>
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Year:</label>
                            <input type="number" class="form-control" id="dashboardSearchYear" placeholder="e.g., 2024" min="2020" max="2030">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchDashboardData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetDashboardSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add Dashboard Data</h3>
                    <form id="dashboardForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Dashboard ID:</label>
                                <input type="text" class="form-control" id="dashboardId" placeholder="e.g., DB-SMS-2024-01" required>
                            </div>
                            <div class="form-group">
                                <label>Dashboard Type:</label>
                                <select class="form-control" id="dashboardType" required>
                                    <option value="SMS">SMS Dashboard</option>
                                    <option value="QMS">QMS Dashboard</option>
                                    <option value="Combined">Combined Dashboard</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Month:</label>
                                <select class="form-control" id="dashboardMonth" required>
                                    <option value="January">January</option>
                                    <option value="February">February</option>
                                    <option value="March">March</option>
                                    <option value="April">April</option>
                                    <option value="May">May</option>
                                    <option value="June">June</option>
                                    <option value="July">July</option>
                                    <option value="August">August</option>
                                    <option value="September">September</option>
                                    <option value="October">October</option>
                                    <option value="November">November</option>
                                    <option value="December">December</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Year:</label>
                                <input type="number" class="form-control" id="dashboardYear" placeholder="e.g., 2024" min="2020" max="2030" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Safety Performance:</label>
                                <input type="text" class="form-control" id="dashboardSafety" placeholder="e.g., 95%" required>
                            </div>
                            <div class="form-group">
                                <label>Quality Performance:</label>
                                <input type="text" class="form-control" id="dashboardQuality" placeholder="e.g., 92%" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Overall Score:</label>
                            <input type="text" class="form-control" id="dashboardOverall" placeholder="e.g., 93%" required>
                        </div>
                        <div class="form-group">
                            <label>Comments:</label>
                            <textarea class="form-control" id="dashboardComments" rows="2" placeholder="Additional comments..."></textarea>
                        </div>
                        
                        <!-- Document Upload for Dashboard -->
                        <div class="document-upload-section">
                            <h4>Upload Dashboard Documents</h4>
                            <div class="document-upload-form">
                                <div class="form-group">
                                    <label>Select Files:</label>
                                    <input type="file" class="form-control" id="dashboardFiles" multiple accept=".pdf,.doc,.docx,.xls,.xlsx">
                                </div>
                                <button type="button" class="btn btn-info" onclick="uploadDashboardDocuments()">
                                    <i class="fas fa-upload"></i> Upload Files
                                </button>
                            </div>
                            <div class="uploaded-documents">
                                <h5>Uploaded Documents:</h5>
                                <ul class="document-list" id="dashboardDocumentList">
                                    <!-- Uploaded documents will be listed here -->
                                </ul>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Dashboard
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>Dashboard Data</h3>
                    <div class="table-container">
                        <table class="table" id="dashboardTable">
                            <thead>
                                <tr>
                                    <th>Dashboard ID</th>
                                    <th>Type</th>
                                    <th>Month</th>
                                    <th>Year</th>
                                    <th>Safety Performance</th>
                                    <th>Quality Performance</th>
                                    <th>Overall Score</th>
                                    <th>Comments</th>
                                    <th>Documents</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="dashboardTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- MOC Section -->
            <div id="moc" class="section">
                <h2><i class="fas fa-exchange-alt"></i> Management of Change (MOC)</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="mocSearchForm">
                        <div class="form-group">
                            <label>Change Type:</label>
                            <select class="form-control" id="mocSearchType">
                                <option value="">All Types</option>
                                <option value="Process">Process Change</option>
                                <option value="Equipment">Equipment Change</option>
                                <option value="Personnel">Personnel Change</option>
                                <option value="Procedure">Procedure Change</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status:</label>
                            <select class="form-control" id="mocSearchStatus">
                                <option value="">All Statuses</option>
                                <option value="Pending">Pending</option>
                                <option value="Approved">Approved</option>
                                <option value="Rejected">Rejected</option>
                                <option value="Implemented">Implemented</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Date:</label>
                            <input type="date" class="form-control" id="mocSearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Date:</label>
                            <input type="date" class="form-control" id="mocSearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchMOCData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetMOCSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add MOC Record</h3>
                    <form id="mocForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>MOC ID:</label>
                                <input type="text" class="form-control" id="mocId" placeholder="e.g., MOC-2024-001" required>
                            </div>
                            <div class="form-group">
                                <label>Change Type:</label>
                                <select class="form-control" id="mocType" required>
                                    <option value="Process">Process Change</option>
                                    <option value="Equipment">Equipment Change</option>
                                    <option value="Personnel">Personnel Change</option>
                                    <option value="Procedure">Procedure Change</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Change Description:</label>
                            <textarea class="form-control" id="mocDesc" rows="3" placeholder="Describe the change..." required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Requested By:</label>
                                <input type="text" class="form-control" id="mocRequestedBy" placeholder="Enter name" required>
                            </div>
                            <div class="form-group">
                                <label>Request Date:</label>
                                <input type="date" class="form-control" id="mocRequestDate" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Risk Assessment Required:</label>
                                <select class="form-control" id="mocRiskAssessment" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status:</label>
                                <select class="form-control" id="mocStatus" required>
                                    <option value="Pending">Pending</option>
                                    <option value="Approved">Approved</option>
                                    <option value="Rejected">Rejected</option>
                                    <option value="Implemented">Implemented</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Approval Comments:</label>
                            <textarea class="form-control" id="mocComments" rows="2" placeholder="Approval comments..."></textarea>
                        </div>
                        
                        <!-- Document Upload for MOC -->
                        <div class="document-upload-section">
                            <h4>Upload MOC Documents & Evidence</h4>
                            <div class="document-upload-form">
                                <div class="form-group">
                                    <label>Select Files:</label>
                                    <input type="file" class="form-control" id="mocFiles" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                                </div>
                                <button type="button" class="btn btn-info" onclick="uploadMOCDocuments()">
                                    <i class="fas fa-upload"></i> Upload Files
                                </button>
                            </div>
                            <div class="uploaded-documents">
                                <h5>Uploaded Documents:</h5>
                                <ul class="document-list" id="mocDocumentList">
                                    <!-- Uploaded documents will be listed here -->
                                </ul>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save MOC
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>MOC Records</h3>
                    <div class="table-container">
                        <table class="table" id="mocTable">
                            <thead>
                                <tr>
                                    <th>MOC ID</th>
                                    <th>Change Type</th>
                                    <th>Description</th>
                                    <th>Requested By</th>
                                    <th>Request Date</th>
                                    <th>Risk Assessment</th>
                                    <th>Status</th>
                                    <th>Comments</th>
                                    <th>Documents</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="mocTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Audits Section -->
            <div id="audits" class="section">
                <h2><i class="fas fa-search"></i> Audits & Inspections</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="auditSearchForm">
                        <div class="form-group">
                            <label>Audit Type:</label>
                            <select class="form-control" id="auditSearchType">
                                <option value="">All Types</option>
                                <option value="Internal">Internal</option>
                                <option value="External">External</option>
                                <option value="Regulatory">Regulatory</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status:</label>
                            <select class="form-control" id="auditSearchStatus">
                                <option value="">All Statuses</option>
                                <option value="Planned">Planned</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Completed">Completed</option>
                                <option value="Closed">Closed</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Date:</label>
                            <input type="date" class="form-control" id="auditSearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Date:</label>
                            <input type="date" class="form-control" id="auditSearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchAuditData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetAuditSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add Audit</h3>
                    <form id="auditForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Audit ID:</label>
                                <input type="text" class="form-control" id="auditId" placeholder="e.g., AUD-2024-001" required>
                            </div>
                            <div class="form-group">
                                <label>Audit Type:</label>
                                <select class="form-control" id="auditType" required>
                                    <option value="Internal">Internal</option>
                                    <option value="External">External</option>
                                    <option value="Regulatory">Regulatory</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Audit Date:</label>
                                <input type="date" class="form-control" id="auditDate" required>
                            </div>
                            <div class="form-group">
                                <label>Auditor:</label>
                                <input type="text" class="form-control" id="auditAuditor" placeholder="Enter auditor name" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Area Audited:</label>
                            <input type="text" class="form-control" id="auditArea" placeholder="Enter area audited" required>
                        </div>
                        <div class="form-group">
                            <label>Findings:</label>
                            <textarea class="form-control" id="auditFindings" rows="3" placeholder="Audit findings..."></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Status:</label>
                                <select class="form-control" id="auditStatus" required>
                                    <option value="Planned">Planned</option>
                                    <option value="In Progress">In Progress</option>
                                    <option value="Completed">Completed</option>
                                    <option value="Closed">Closed</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Plan Date:</label>
                                <input type="date" class="form-control" id="auditPlanDate" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Due Date for Actions:</label>
                            <input type="date" class="form-control" id="auditDueDate">
                        </div>
                        
                        <!-- Audit Findings Status -->
                        <div class="form-group">
                            <label>Findings Status:</label>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="auditCAPAReceived"> CAPA Received
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="auditRCCADone"> RCCA Done
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="auditImplementationEvidenceReceived"> Implementation Evidence Received
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Audit
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>Audit List</h3>
                    <div class="table-container">
                        <table class="table" id="auditTable">
                            <thead>
                                <tr>
                                    <th>Audit ID</th>
                                    <th>Type</th>
                                    <th>Date</th>
                                    <th>Auditor</th>
                                    <th>Area</th>
                                    <th>Findings</th>
                                    <th>Status</th>
                                    <th>Plan Date</th>
                                    <th>Due Date</th>
                                    <th>Findings Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="auditTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Audit Plan/Schedule Table -->
                <div class="card">
                    <h3>Audit Plan / Schedule</h3>
                    <div class="table-container">
                        <table class="audit-plan-table">
                            <thead>
                                <tr>
                                    <th>Audit Area</th>
                                    <th class="month-header">Jan</th>
                                    <th class="month-header">Feb</th>
                                    <th class="month-header">Mar</th>
                                    <th class="month-header">Apr</th>
                                    <th class="month-header">May</th>
                                    <th class="month-header">Jun</th>
                                    <th class="month-header">Jul</th>
                                    <th class="month-header">Aug</th>
                                    <th class="month-header">Sep</th>
                                    <th class="month-header">Oct</th>
                                    <th class="month-header">Nov</th>
                                    <th class="month-header">Dec</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Cargo Operations</td>
                                    <td><span class="status-completed">Completed</span></td>
                                    <td></td>
                                    <td></td>
                                    <td><span class="status-pending">Planned</span></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>Ground Handling</td>
                                    <td></td>
                                    <td><span class="status-completed">Completed</span></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><span class="status-pending">Planned</span></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>Dangerous Goods</td>
                                    <td></td>
                                    <td></td>
                                    <td><span class="status-completed">Completed</span></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><span class="status-pending">Planned</span></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>Warehouse Operations</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><span class="status-completed">Completed</span></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><span class="status-pending">Planned</span></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>Security Procedures</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><span class="status-completed">Completed</span></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><span class="status-pending">Planned</span></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- SPI Section -->
            <div id="spi" class="section">
                <h2><i class="fas fa-chart-bar"></i> Safety Performance Indicators (SPI)</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="spiSearchForm">
                        <div class="form-group">
                            <label>Indicator Type:</label>
                            <select class="form-control" id="spiSearchType">
                                <option value="">All Types</option>
                                <option value="Safety">Safety</option>
                                <option value="Quality">Quality</option>
                                <option value="Operational">Operational</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status:</label>
                            <select class="form-control" id="spiSearchStatus">
                                <option value="">All Statuses</option>
                                <option value="Red">Red</option>
                                <option value="Green">Green</option>
                                <option value="Yellow">Yellow</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Date:</label>
                            <input type="date" class="form-control" id="spiSearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Date:</label>
                            <input type="date" class="form-control" id="spiSearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchSPIData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetSPISearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add SPI Data</h3>
                    <form id="spiForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>SPI ID:</label>
                                <input type="text" class="form-control" id="spiId" placeholder="e.g., SPI-2024-001" required>
                            </div>
                            <div class="form-group">
                                <label>Indicator Type:</label>
                                <select class="form-control" id="spiType" required>
                                    <option value="Safety">Safety</option>
                                    <option value="Quality">Quality</option>
                                    <option value="Operational">Operational</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Indicator Name:</label>
                                <input type="text" class="form-control" id="spiName" placeholder="Enter indicator name" required>
                            </div>
                            <div class="form-group">
                                <label>Measurement Date:</label>
                                <input type="date" class="form-control" id="spiDate" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Target Value:</label>
                                <input type="text" class="form-control" id="spiTarget" placeholder="e.g., 95%" required>
                            </div>
                            <div class="form-group">
                                <label>Actual Value:</label>
                                <input type="text" class="form-control" id="spiActual" placeholder="e.g., 92%" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Status:</label>
                            <select class="form-control" id="spiStatus" required>
                                <option value="Red">Red</option>
                                <option value="Green">Green</option>
                                <option value="Yellow">Yellow</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Comments:</label>
                            <textarea class="form-control" id="spiComments" rows="2" placeholder="Additional comments..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save SPI
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>SPI Data</h3>
                    <div class="table-container">
                        <table class="table" id="spiTable">
                            <thead>
                                <tr>
                                    <th>SPI ID</th>
                                    <th>Type</th>
                                    <th>Name</th>
                                    <th>Date</th>
                                    <th>Target</th>
                                    <th>Actual</th>
                                    <th>Status</th>
                                    <th>Comments</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="spiTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Outstation Section -->
            <div id="outstation" class="section">
                <h2><i class="fas fa-building"></i> Outstation Monitoring</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="outstationSearchForm">
                        <div class="form-group">
                            <label>Station:</label>
                            <select class="form-control" id="outstationSearchStation">
                                <option value="">All Stations</option>
                                <option value="ADD">Addis Ababa (ADD)</option>
                                <option value="JNB">Johannesburg (JNB)</option>
                                <option value="NBO">Nairobi (NBO)</option>
                                <option value="LHR">London (LHR)</option>
                                <option value="DXB">Dubai (DXB)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status:</label>
                            <select class="form-control" id="outstationSearchStatus">
                                <option value="">All Statuses</option>
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                                <option value="Under Review">Under Review</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchOutstationData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetOutstationSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add Outstation</h3>
                    <form id="outstationForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Station Code:</label>
                                <input type="text" class="form-control" id="outstationCode" placeholder="e.g., ADD" required>
                            </div>
                            <div class="form-group">
                                <label>Station Name:</label>
                                <input type="text" class="form-control" id="outstationName" placeholder="e.g., Addis Ababa" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Country:</label>
                                <input type="text" class="form-control" id="outstationCountry" placeholder="e.g., Ethiopia" required>
                            </div>
                            <div class="form-group">
                                <label>Status:</label>
                                <select class="form-control" id="outstationStatus" required>
                                    <option value="Active">Active</option>
                                    <option value="Inactive">Inactive</option>
                                    <option value="Under Review">Under Review</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Safety Officer:</label>
                            <input type="text" class="form-control" id="outstationOfficer" placeholder="Enter safety officer name">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Last Audit Date:</label>
                                <input type="date" class="form-control" id="outstationAuditDate">
                            </div>
                            <div class="form-group">
                                <label>Occurrences/Incidents:</label>
                                <input type="number" class="form-control" id="outstationOccurrences" placeholder="Number of occurrences" min="0">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Audit Findings:</label>
                                <input type="number" class="form-control" id="outstationAuditFindings" placeholder="Number of findings" min="0">
                            </div>
                            <div class="form-group">
                                <label>DG Occurrences:</label>
                                <input type="number" class="form-control" id="outstationDGOccurrences" placeholder="Number of DG occurrences" min="0">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Hazards:</label>
                            <input type="number" class="form-control" id="outstationHazards" placeholder="Number of hazards" min="0">
                        </div>
                        <div class="form-group">
                            <label>Comments:</label>
                            <textarea class="form-control" id="outstationComments" rows="2" placeholder="Additional comments..."></textarea>
                        </div>
                        
                        <!-- Document Upload for Outstation -->
                        <div class="document-upload-section">
                            <h4>Upload Outstation Documents</h4>
                            <div class="document-upload-form">
                                <div class="form-group">
                                    <label>Select Files:</label>
                                    <input type="file" class="form-control" id="outstationFiles" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                                </div>
                                <button type="button" class="btn btn-info" onclick="uploadOutstationDocuments()">
                                    <i class="fas fa-upload"></i> Upload Files
                                </button>
                            </div>
                            <div class="uploaded-documents">
                                <h5>Uploaded Documents:</h5>
                                <ul class="document-list" id="outstationDocumentList">
                                    <!-- Uploaded documents will be listed here -->
                                </ul>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Outstation
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>Outstation List</h3>
                    <div class="table-container">
                        <table class="table" id="outstationTable">
                            <thead>
                                <tr>
                                    <th>Station Code</th>
                                    <th>Station Name</th>
                                    <th>Country</th>
                                    <th>Status</th>
                                    <th>Safety Officer</th>
                                    <th>Last Audit</th>
                                    <th>Occurrences</th>
                                    <th>Audit Findings</th>
                                    <th>DG Occurrences</th>
                                    <th>Hazards</th>
                                    <th>Comments</th>
                                    <th>Documents</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="outstationTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ISARPS List Section -->
            <div id="isarps" class="section">
                <h2><i class="fas fa-list"></i> ISARPS List</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="isarpsSearchForm">
                        <div class="form-group">
                            <label>Status:</label>
                            <select class="form-control" id="isarpsSearchStatus">
                                <option value="">All Statuses</option>
                                <option value="Completed">Completed</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Risk Level:</label>
                            <select class="form-control" id="isarpsSearchRisk">
                                <option value="">All Levels</option>
                                <option value="Low">Low</option>
                                <option value="Medium">Medium</option>
                                <option value="High">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Due Date:</label>
                            <input type="date" class="form-control" id="isarpsSearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Due Date:</label>
                            <input type="date" class="form-control" id="isarpsSearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchISARPSData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetISARPSSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add ISARPS</h3>
                    <form id="isarpsForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>ISARPS ID:</label>
                                <input type="text" class="form-control" id="isarpsId" placeholder="e.g., ISARPS-CARGO-001" required>
                            </div>
                            <div class="form-group">
                                <label>Title:</label>
                                <input type="text" class="form-control" id="isarpsTitle" placeholder="Enter ISARPS title" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Description:</label>
                            <textarea class="form-control" id="isarpsDesc" rows="3" placeholder="Describe the ISARPS..." required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Manual Reference:</label>
                                <input type="text" class="form-control" id="isarpsManualRef" placeholder="e.g., Cargo Manual Section 4.5" required>
                            </div>
                            <div class="form-group">
                                <label>Manual Link:</label>
                                <input type="url" class="form-control" id="isarpsManualLink" placeholder="https://...">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Status:</label>
                                <select class="form-control" id="isarpsStatus" required>
                                    <option value="Completed">Completed</option>
                                    <option value="In Progress">In Progress</option>
                                    <option value="Pending">Pending</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Due Date:</label>
                                <input type="date" class="form-control" id="isarpsDueDate" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Risk Level:</label>
                                <select class="form-control" id="isarpsRisk" required>
                                    <option value="Low">Low</option>
                                    <option value="Medium">Medium</option>
                                    <option value="High">High</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Responsible Person:</label>
                                <input type="text" class="form-control" id="isarpsResponsible" placeholder="Enter responsible person" required>
                            </div>
                        </div>
                        
                        <!-- Document Upload for ISARPS -->
                        <div class="document-upload-section">
                            <h4>Upload ISARPS Documents</h4>
                            <div class="document-upload-form">
                                <div class="form-group">
                                    <label>Select Files:</label>
                                    <input type="file" class="form-control" id="isarpsFiles" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                                </div>
                                <button type="button" class="btn btn-info" onclick="uploadISARPSDocuments()">
                                    <i class="fas fa-upload"></i> Upload Files
                                </button>
                            </div>
                            <div class="uploaded-documents">
                                <h5>Uploaded Documents:</h5>
                                <ul class="document-list" id="isarpsDocumentList">
                                    <!-- Uploaded documents will be listed here -->
                                </ul>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save ISARPS
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>ISARPS List</h3>
                    <div class="table-container">
                        <table class="table" id="isarpsTable">
                            <thead>
                                <tr>
                                    <th>ISARPS ID</th>
                                    <th>Title</th>
                                    <th>Description</th>
                                    <th>Manual Reference</th>
                                    <th>Status</th>
                                    <th>Due Date</th>
                                    <th>Risk Level</th>
                                    <th>Responsible</th>
                                    <th>Documents</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="isarpsTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Evidences Section -->
            <div id="evidences" class="section">
                <h2><i class="fas fa-file-alt"></i> Implementation Evidences</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="evidenceSearchForm">
                        <div class="form-group">
                            <label>ISARPS Reference:</label>
                            <select class="form-control" id="evidenceSearchIsarps">
                                <option value="">All ISARPS</option>
                                <!-- Options will be populated from ISARPS list -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status:</label>
                            <select class="form-control" id="evidenceSearchStatus">
                                <option value="">All Statuses</option>
                                <option value="Completed">Completed</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Date:</label>
                            <input type="date" class="form-control" id="evidenceSearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Date:</label>
                            <input type="date" class="form-control" id="evidenceSearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchEvidenceData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetEvidenceSearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add Evidence</h3>
                    <form id="evidenceForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>ISARPS Reference:</label>
                                <select class="form-control" id="evidenceIsarps" required>
                                    <option value="">Select ISARPS</option>
                                    <!-- Options will be populated from ISARPS list -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Evidence ID:</label>
                                <input type="text" class="form-control" id="evidenceId" placeholder="e.g., EVID-2024-001" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Evidence Description:</label>
                            <textarea class="form-control" id="evidenceDesc" rows="3" placeholder="Describe the evidence..." required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Date of Evidence:</label>
                                <input type="date" class="form-control" id="evidenceDate" required>
                            </div>
                            <div class="form-group">
                                <label>Status:</label>
                                <select class="form-control" id="evidenceStatus" required>
                                    <option value="Completed">Completed</option>
                                    <option value="In Progress">In Progress</option>
                                    <option value="Pending">Pending</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Upload File:</label>
                            <input type="file" class="form-control" id="evidenceFile">
                        </div>
                        <div class="form-group">
                            <label>Comments:</label>
                            <textarea class="form-control" id="evidenceComments" rows="2" placeholder="Additional comments..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Evidence
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>Evidence List</h3>
                    <div class="table-container">
                        <table class="table" id="evidenceTable">
                            <thead>
                                <tr>
                                    <th>Evidence ID</th>
                                    <th>ISARPS Reference</th>
                                    <th>Description</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>File</th>
                                    <th>Comments</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="evidenceTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Safety Promotion Section -->
            <div id="safety" class="section">
                <h2><i class="fas fa-bullhorn"></i> Safety Promotion</h2>
                
                <div class="search-section">
                    <h3>Search & Filter</h3>
                    <form class="search-form" id="safetySearchForm">
                        <div class="form-group">
                            <label>Activity Type:</label>
                            <select class="form-control" id="safetySearchType">
                                <option value="">All Types</option>
                                <option value="Training">Training</option>
                                <option value="Campaign">Campaign</option>
                                <option value="Meeting">Meeting</option>
                                <option value="Workshop">Workshop</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>From Date:</label>
                            <input type="date" class="form-control" id="safetySearchFrom">
                        </div>
                        <div class="form-group">
                            <label>To Date:</label>
                            <input type="date" class="form-control" id="safetySearchTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info" onclick="searchSafetyData()">
                                <i class="fas fa-search"></i> Search
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetSafetySearch()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Add Safety Activity</h3>
                    <form id="safetyForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Activity ID:</label>
                                <input type="text" class="form-control" id="safetyId" placeholder="e.g., SAFETY-2024-001" required>
                            </div>
                            <div class="form-group">
                                <label>Activity Type:</label>
                                <select class="form-control" id="safetyType" required>
                                    <option value="Training">Training</option>
                                    <option value="Campaign">Campaign</option>
                                    <option value="Meeting">Meeting</option>
                                    <option value="Workshop">Workshop</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Activity Title:</label>
                            <input type="text" class="form-control" id="safetyTitle" placeholder="Enter activity title" required>
                        </div>
                        <div class="form-group">
                            <label>Description:</label>
                            <textarea class="form-control" id="safetyDesc" rows="3" placeholder="Describe the activity..." required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Date:</label>
                                <input type="date" class="form-control" id="safetyDate" required>
                            </div>
                            <div class="form-group">
                                <label>Participants:</label>
                                <input type="number" class="form-control" id="safetyParticipants" placeholder="Number of participants" min="1">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Location:</label>
                            <input type="text" class="form-control" id="safetyLocation" placeholder="Enter location">
                        </div>
                        <div class="form-group">
                            <label>Outcomes:</label>
                            <textarea class="form-control" id="safetyOutcomes" rows="2" placeholder="Activity outcomes..."></textarea>
                        </div>
                        
                        <!-- Document Upload for Safety Promotion -->
                        <div class="document-upload-section">
                            <h4>Upload Safety Promotion Documents</h4>
                            <div class="document-upload-form">
                                <div class="form-group">
                                    <label>Select Files:</label>
                                    <input type="file" class="form-control" id="safetyFiles" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.ppt,.pptx">
                                </div>
                                <button type="button" class="btn btn-info" onclick="uploadSafetyDocuments()">
                                    <i class="fas fa-upload"></i> Upload Files
                                </button>
                            </div>
                            <div class="uploaded-documents">
                                <h5>Uploaded Documents:</h5>
                                <ul class="document-list" id="safetyDocumentList">
                                    <!-- Uploaded documents will be listed here -->
                                </ul>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Activity
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3>Safety Activities</h3>
                    <div class="table-container">
                        <table class="table" id="safetyTable">
                            <thead>
                                <tr>
                                    <th>Activity ID</th>
                                    <th>Type</th>
                                    <th>Title</th>
                                    <th>Description</th>
                                    <th>Date</th>
                                    <th>Participants</th>
                                    <th>Location</th>
                                    <th>Outcomes</th>
                                    <th>Documents</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="safetyTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Placeholder sections for other pillars -->
            <div id="safety-policy" class="section">
                <div class="card">
                    <h2><i class="fas fa-cog"></i> Safety Policy & Management Review</h2>
                    <p>This section contains management-level safety policies and review processes.</p>
                    <p>Use the navigation menu or the links below to access specific sub-sections:</p>
                    <div class="action-buttons">
                        <button class="btn btn-info" onclick="showSection('sag')">
                            <i class="fas fa-users"></i> Go to SAG
                        </button>
                        <button class="btn btn-info" onclick="showSection('monthly-dashboard')">
                            <i class="fas fa-chart-line"></i> Go to Monthly Dashboard
                        </button>
                        <button class="btn btn-info" onclick="showSection('moc')">
                            <i class="fas fa-exchange-alt"></i> Go to MOC
                        </button>
                    </div>
                </div>
            </div>

            <div id="safety-assurance" class="section">
                <div class="card">
                    <h2><i class="fas fa-shield-alt"></i> Safety Assurance</h2>
                    <p>This section contains safety assurance activities and monitoring processes.</p>
                    <p>Use the navigation menu or the links below to access specific sub-sections:</p>
                    <div class="action-buttons">
                        <button class="btn btn-info" onclick="showSection('audits')">
                            <i class="fas fa-search"></i> Go to Audits
                        </button>
                        <button class="btn btn-info" onclick="showSection('spi')">
                            <i class="fas fa-chart-bar"></i> Go to SPI
                        </button>
                        <button class="btn btn-info" onclick="showSection('outstation')">
                            <i class="fas fa-building"></i> Go to Outstation
                        </button>
                        <button class="btn btn-info" onclick="showSection('isarps')">
                            <i class="fas fa-list"></i> Go to ISARPS List
                        </button>
                        <button class="btn btn-info" onclick="showSection('evidences')">
                            <i class="fas fa-file-alt"></i> Go to Evidences
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        const state = {
            isarps: [],
            evidences: [],
            outstations: [],
            safetyActivities: [],
            mocRecords: [],
            sagMeetings: [],
            risks: [],
            spis: [],
            occurrences: [],
            audits: [],
            dashboards: [],
            user: null,
            // Document storage
            documents: {
                risk: [],
                occurrence: [],
                sag: [],
                dashboard: [],
                moc: [],
                audit: [],
                spi: [],
                outstation: [],
                isarps: [],
                evidence: [],
                safety: []
            }
        };

        // DOM Elements
        const loginPage = document.getElementById('login-page');
        const homePage = document.getElementById('home-page');
        const mainApp = document.getElementById('main-app');
        const loginForm = document.getElementById('loginForm');
        const userDisplay = document.getElementById('userDisplay');

        // Login Functionality
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // Simple authentication
            if (username === 'admin' && password === 'safety2024') {
                state.user = { username: username, role: 'Administrator' };
                userDisplay.textContent = `Welcome, ${state.user.username}`;
                loginPage.style.display = 'none';
                homePage.style.display = 'flex';
                loadSampleData();
            } else {
                alert('Invalid credentials. Please use admin/safety2024');
            }
        });

        // Navigation Functions
        function showHomePage() {
            mainApp.style.display = 'none';
            homePage.style.display = 'flex';
        }

        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Show main app if coming from home page
            if (homePage.style.display !== 'none') {
                homePage.style.display = 'none';
                mainApp.style.display = 'block';
            }
            
            // Add active class to clicked button if it exists
            const navButtons = document.querySelectorAll('.nav-btn');
            for (let btn of navButtons) {
                if (btn.onclick && btn.onclick.toString().includes(sectionId)) {
                    btn.classList.add('active');
                    break;
                }
            }
            
            // Update dashboard if showing dashboard
            if (sectionId === 'dashboard') {
                updateDashboard();
            }
            
            // Populate ISARPS dropdowns if showing evidences section
            if (sectionId === 'evidences') {
                populateISARPSDropdowns();
            }
        }

        function logout() {
            state.user = null;
            mainApp.style.display = 'none';
            homePage.style.display = 'none';
            loginPage.style.display = 'flex';
            loginForm.reset();
        }

        // Load Sample Data
        function loadSampleData() {
            // Sample ISARPS data
            state.isarps = [
                {
                    id: 'ISARPS-CARGO-001',
                    title: 'Cargo Loading Procedures',
                    description: 'Implementation of standardized cargo loading procedures as per ISARPS 18th Edition',
                    manualRef: 'Cargo Manual Section 4.5',
                    manualLink: 'https://portal.company.com/manuals/cargo-section-4.5',
                    status: 'Completed',
                    dueDate: '2024-03-15',
                    risk: 'Medium',
                    responsible: 'John Smith'
                },
                {
                    id: 'ISARPS-CARGO-002',
                    title: 'Dangerous Goods Handling',
                    description: 'Updated procedures for dangerous goods identification, documentation and handling',
                    manualRef: 'DG Manual Section 3.2',
                    manualLink: 'https://portal.company.com/manuals/dg-section-3.2',
                    status: 'In Progress',
                    dueDate: '2024-04-30',
                    risk: 'High',
                    responsible: 'Sarah Johnson'
                },
                {
                    id: 'ISARPS-CARGO-003',
                    title: 'Uld Management System',
                    description: 'Implementation of enhanced ULD tracking and management system',
                    manualRef: 'Ground Operations Manual Section 7.1',
                    manualLink: 'https://portal.company.com/manuals/ground-ops-section-7.1',
                    status: 'Pending',
                    dueDate: '2024-05-15',
                    risk: 'Low',
                    responsible: 'Mike Davis'
                }
            ];

            // Sample Risk data (Bowtie format)
            state.risks = [
                {
                    id: 'RISK-2024-001',
                    category: 'Safety',
                    hazard: 'Inadequate training for new cargo handling equipment',
                    topEvent: 'Equipment misuse leading to injury or damage',
                    threats: 'Untrained operators, Lack of supervision, Inadequate procedures',
                    consequences: 'Operator injury, Equipment damage, Operational delays',
                    preventiveBarriers: 'Training program, Supervision, Equipment checks',
                    recoveryBarriers: 'Emergency response, Medical assistance, Equipment repair',
                    likelihood: 'Occasional',
                    severity: 'Major',
                    level: 'Moderate',
                    responsible: 'Training Manager',
                    dueDate: '2024-06-30',
                    dateIdentified: '2024-01-15',
                    controlEffectiveness: 'Medium',
                    riskOwner: 'Operations Director'
                },
                {
                    id: 'RISK-2024-002',
                    category: 'Operational',
                    hazard: 'Potential ULD tracking system failure',
                    topEvent: 'ULD tracking system failure during peak operations',
                    threats: 'System overload, Network failure, Hardware malfunction',
                    consequences: 'ULD misplacement, Flight delays, Customer dissatisfaction',
                    preventiveBarriers: 'System monitoring, Regular maintenance, Backup systems',
                    recoveryBarriers: 'Manual tracking, Communication protocols, Recovery procedures',
                    likelihood: 'Remote',
                    severity: 'Hazardous',
                    level: 'Intolerable',
                    responsible: 'IT Manager',
                    dueDate: '2024-05-15',
                    dateIdentified: '2024-01-20',
                    controlEffectiveness: 'High',
                    riskOwner: 'IT Director'
                }
            ];

            // Sample Evidence data
            state.evidences = [
                {
                    id: 'EVID-2024-001',
                    isarpsRef: 'ISARPS-CARGO-001',
                    description: 'Training records for cargo loading procedures',
                    date: '2024-03-10',
                    status: 'Completed',
                    file: 'training_records.pdf',
                    comments: 'All staff trained successfully'
                },
                {
                    id: 'EVID-2024-002',
                    isarpsRef: 'ISARPS-CARGO-002',
                    description: 'Updated DG handling manual',
                    date: '2024-02-28',
                    status: 'In Progress',
                    file: 'dg_manual_v2.pdf',
                    comments: 'Awaiting final approval'
                }
            ];

            // Sample Dashboard data
            state.dashboards = [
                {
                    id: 'DB-SMS-2024-01',
                    type: 'SMS Dashboard',
                    month: 'January',
                    year: '2024',
                    safetyPerformance: '95%',
                    qualityPerformance: '92%',
                    overallScore: '93%',
                    comments: 'All safety indicators within acceptable limits'
                }
            ];

            // Sample Occurrence data
            state.occurrences = [
                {
                    id: 'OCC-2024-001',
                    dateTime: '2024-01-15T10:30',
                    type: 'Ground Damage',
                    severity: 'Medium',
                    description: 'Minor damage to cargo container during loading',
                    location: 'ADD Cargo Terminal',
                    flightNo: 'ET500',
                    actions: 'Container removed from service for repair'
                }
            ];

            // Sample SAG data
            state.sagMeetings = [
                {
                    id: 'SAG-2024-001',
                    date: '2024-01-10',
                    type: 'Monthly',
                    chairperson: 'Safety Manager',
                    attendance: 'John Smith, Sarah Johnson, Mike Davis, Lisa Brown',
                    agenda: 'Review of safety performance indicators',
                    actions: 'Implement new training program',
                    nextDate: '2024-02-10'
                }
            ];

            // Sample MOC data
            state.mocRecords = [
                {
                    id: 'MOC-2024-001',
                    type: 'Process',
                    description: 'Implementation of new cargo scanning procedure',
                    requestedBy: 'Operations Manager',
                    requestDate: '2024-01-05',
                    riskAssessment: 'Yes',
                    status: 'Approved',
                    comments: 'Procedure to be implemented after staff training'
                }
            ];

            // Sample Audit data
            state.audits = [
                {
                    id: 'AUD-2024-001',
                    type: 'Internal',
                    date: '2024-01-20',
                    auditor: 'Quality Manager',
                    area: 'Cargo Handling',
                    findings: 'Minor non-conformances in documentation',
                    status: 'Completed',
                    planDate: '2024-01-15',
                    dueDate: '2024-02-20',
                    capaReceived: true,
                    rccaDone: true,
                    implementationEvidenceReceived: false
                }
            ];

            // Sample SPI data
            state.spis = [
                {
                    id: 'SPI-2024-001',
                    type: 'Safety',
                    name: 'Ground Damage Incidents',
                    date: '2024-01-31',
                    target: ' 2 incidents',
                    actual: '1 incident',
                    status: 'Green',
                    comments: 'Within target range'
                }
            ];

            // Sample Outstation data
            state.outstations = [
                {
                    code: 'ADD',
                    name: 'Addis Ababa',
                    country: 'Ethiopia',
                    status: 'Active',
                    officer: 'Safety Officer 1',
                    auditDate: '2024-01-15',
                    occurrences: 2,
                    auditFindings: 3,
                    dgOccurrences: 0,
                    hazards: 1,
                    comments: 'All procedures compliant'
                }
            ];

            // Sample Safety Promotion data
            state.safetyActivities = [
                {
                    id: 'SAFETY-2024-001',
                    type: 'Training',
                    title: 'Dangerous Goods Awareness',
                    description: 'Annual dangerous goods handling training',
                    date: '2024-01-25',
                    participants: 45,
                    location: 'Training Room A',
                    outcomes: 'All staff certified'
                }
            ];

            // Update UI with sample data
            updateISARPSTable();
            updateRiskTable();
            updateEvidenceTable();
            updateDashboardTable();
            updateOccurrenceTable();
            updateSAGTable();
            updateMOCTable();
            updateAuditTable();
            updateSPITable();
            updateOutstationTable();
            updateSafetyTable();
            updateDashboard();
        }

        // Populate ISARPS dropdowns in Evidences section
        function populateISARPSDropdowns() {
            const searchDropdown = document.getElementById('evidenceSearchIsarps');
            const formDropdown = document.getElementById('evidenceIsarps');
            
            if (searchDropdown && formDropdown) {
                // Clear existing options except the first one
                while (searchDropdown.children.length > 1) {
                    searchDropdown.removeChild(searchDropdown.lastChild);
                }
                while (formDropdown.children.length > 1) {
                    formDropdown.removeChild(formDropdown.lastChild);
                }
                
                // Add ISARPS options
                state.isarps.forEach(isarps => {
                    const searchOption = document.createElement('option');
                    searchOption.value = isarps.id;
                    searchOption.textContent = `${isarps.id} - ${isarps.title}`;
                    searchDropdown.appendChild(searchOption);
                    
                    const formOption = document.createElement('option');
                    formOption.value = isarps.id;
                    formOption.textContent = `${isarps.id} - ${isarps.title}`;
                    formDropdown.appendChild(formOption);
                });
            }
        }

        // Update Dashboard
        function updateDashboard() {
            const totalIsarps = state.isarps.length;
            const completedIsarps = state.isarps.filter(item => item.status === 'Completed').length;
            const progressIsarps = state.isarps.filter(item => item.status === 'In Progress').length;
            const pendingIsarps = state.isarps.filter(item => item.status === 'Pending').length;
            
            document.getElementById('totalIsarps').textContent = totalIsarps;
            document.getElementById('completedIsarps').textContent = completedIsarps;
            document.getElementById('progressIsarps').textContent = progressIsarps;
            document.getElementById('pendingIsarps').textContent = pendingIsarps;
            
            const progressPercent = totalIsarps > 0 ? Math.round((completedIsarps / totalIsarps) * 100) : 0;
            document.getElementById('progressBar').style.width = `${progressPercent}%`;
            document.getElementById('progressText').textContent = `${progressPercent}% Complete (${completedIsarps} of ${totalIsarps} ISARPS implemented)`;
            
            // Update recent activities
            const recentActivities = document.getElementById('recentActivities');
            recentActivities.innerHTML = '';
            
            if (state.isarps.length > 0) {
                state.isarps.slice(0, 5).forEach(isarps => {
                    const li = document.createElement('li');
                    li.style.padding = '10px';
                    li.style.borderBottom = '1px solid #eee';
                    li.innerHTML = `<strong>${isarps.id}</strong>: ${isarps.title} - <span class="status-${isarps.status.toLowerCase().replace(' ', '-')}">${isarps.status}</span>`;
                    recentActivities.appendChild(li);
                });
            } else {
                const li = document.createElement('li');
                li.style.padding = '10px';
                li.style.borderBottom = '1px solid #eee';
                li.textContent = 'No activities yet';
                recentActivities.appendChild(li);
            }
            
            // Initialize charts
            initializeCharts();
        }

        // Initialize Charts
        function initializeCharts() {
            // Occurrence Trend Chart
            const occurrenceCtx = document.getElementById('occurrenceChart');
            if (occurrenceCtx) {
                new Chart(occurrenceCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Occurrences',
                            data: [5, 3, 7, 4, 6, 2],
                            borderColor: '#1f77b4',
                            backgroundColor: 'rgba(31, 119, 180, 0.1)',
                            tension: 0.3,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Number of Occurrences'
                                }
                            }
                        }
                    }
                });
            }

            // SPI Trend Chart
            const spiCtx = document.getElementById('spiChart');
            if (spiCtx) {
                new Chart(spiCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Safety', 'Quality', 'Operational', 'Compliance'],
                        datasets: [{
                            label: 'SPI Score (%)',
                            data: [92, 85, 95, 88],
                            backgroundColor: [
                                'rgba(40, 167, 69, 0.7)',
                                'rgba(255, 193, 7, 0.7)',
                                'rgba(23, 162, 184, 0.7)',
                                'rgba(108, 117, 125, 0.7)'
                            ],
                            borderColor: [
                                'rgb(40, 167, 69)',
                                'rgb(255, 193, 7)',
                                'rgb(23, 162, 184)',
                                'rgb(108, 117, 125)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Score (%)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update Tables
        function updateISARPSTable() {
            const tbody = document.getElementById('isarpsTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.isarps.forEach(isarps => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${isarps.id}</td>
                        <td>${isarps.title}</td>
                        <td>${isarps.description}</td>
                        <td>${isarps.manualRef}</td>
                        <td><span class="status-${isarps.status.toLowerCase().replace(' ', '-')}">${isarps.status}</span></td>
                        <td>${formatDate(isarps.dueDate)}</td>
                        <td><span class="risk-${isarps.risk.toLowerCase()}">${isarps.risk}</span></td>
                        <td>${isarps.responsible}</td>
                        <td>${getDocumentCount('isarps', isarps.id)}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editISARPS('${isarps.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteISARPS('${isarps.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateRiskTable() {
            const tbody = document.getElementById('riskTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.risks.forEach(risk => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${risk.id}</td>
                        <td>${risk.category}</td>
                        <td>${risk.hazard}</td>
                        <td>${risk.topEvent}</td>
                        <td>${risk.threats}</td>
                        <td>${risk.consequences}</td>
                        <td>${risk.preventiveBarriers}</td>
                        <td>${risk.recoveryBarriers}</td>
                        <td>${risk.likelihood}</td>
                        <td>${risk.severity}</td>
                        <td><span class="risk-${risk.level.toLowerCase()}">${risk.level}</span></td>
                        <td>${risk.responsible}</td>
                        <td>${formatDate(risk.dueDate)}</td>
                        <td>${formatDate(risk.dateIdentified)}</td>
                        <td>${risk.controlEffectiveness}</td>
                        <td>${risk.riskOwner}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editRisk('${risk.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteRisk('${risk.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateEvidenceTable() {
            const tbody = document.getElementById('evidenceTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.evidences.forEach(evidence => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${evidence.id}</td>
                        <td>${evidence.isarpsRef}</td>
                        <td>${evidence.description}</td>
                        <td>${formatDate(evidence.date)}</td>
                        <td><span class="status-${evidence.status.toLowerCase().replace(' ', '-')}">${evidence.status}</span></td>
                        <td>${evidence.file ? `<a href="#" class="btn btn-info btn-sm"><i class="fas fa-download"></i> Download</a>` : 'No file'}</td>
                        <td>${evidence.comments}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editEvidence('${evidence.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteEvidence('${evidence.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateDashboardTable() {
            const tbody = document.getElementById('dashboardTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.dashboards.forEach(dashboard => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${dashboard.id}</td>
                        <td>${dashboard.type}</td>
                        <td>${dashboard.month}</td>
                        <td>${dashboard.year}</td>
                        <td>${dashboard.safetyPerformance}</td>
                        <td>${dashboard.qualityPerformance}</td>
                        <td>${dashboard.overallScore}</td>
                        <td>${dashboard.comments}</td>
                        <td>${getDocumentCount('dashboard', dashboard.id)}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editDashboard('${dashboard.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteDashboard('${dashboard.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateOccurrenceTable() {
            const tbody = document.getElementById('occurrenceTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.occurrences.forEach(occurrence => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${occurrence.id}</td>
                        <td>${formatDateTime(occurrence.dateTime)}</td>
                        <td>${occurrence.type}</td>
                        <td><span class="risk-${occurrence.severity.toLowerCase()}">${occurrence.severity}</span></td>
                        <td>${occurrence.description}</td>
                        <td>${occurrence.location}</td>
                        <td>${occurrence.flightNo}</td>
                        <td>${getDocumentCount('occurrence', occurrence.id)}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editOccurrence('${occurrence.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteOccurrence('${occurrence.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateSAGTable() {
            const tbody = document.getElementById('sagTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.sagMeetings.forEach(sag => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${sag.id}</td>
                        <td>${formatDate(sag.date)}</td>
                        <td>${sag.type}</td>
                        <td>${sag.chairperson}</td>
                        <td>${sag.attendance}</td>
                        <td>${sag.agenda}</td>
                        <td>${sag.actions}</td>
                        <td>${formatDate(sag.nextDate)}</td>
                        <td>${getDocumentCount('sag', sag.id)}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editSAG('${sag.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteSAG('${sag.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateMOCTable() {
            const tbody = document.getElementById('mocTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.mocRecords.forEach(moc => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${moc.id}</td>
                        <td>${moc.type}</td>
                        <td>${moc.description}</td>
                        <td>${moc.requestedBy}</td>
                        <td>${formatDate(moc.requestDate)}</td>
                        <td>${moc.riskAssessment}</td>
                        <td><span class="status-${moc.status.toLowerCase().replace(' ', '-')}">${moc.status}</span></td>
                        <td>${moc.comments}</td>
                        <td>${getDocumentCount('moc', moc.id)}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editMOC('${moc.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteMOC('${moc.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateAuditTable() {
            const tbody = document.getElementById('auditTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.audits.forEach(audit => {
                    const statusIcons = [];
                    if (audit.capaReceived) statusIcons.push('<span class="status-completed">CAPA</span>');
                    if (audit.rccaDone) statusIcons.push('<span class="status-completed">RCCA</span>');
                    if (audit.implementationEvidenceReceived) statusIcons.push('<span class="status-completed">IMP</span>');
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${audit.id}</td>
                        <td>${audit.type}</td>
                        <td>${formatDate(audit.date)}</td>
                        <td>${audit.auditor}</td>
                        <td>${audit.area}</td>
                        <td>${audit.findings}</td>
                        <td><span class="status-${audit.status.toLowerCase().replace(' ', '-')}">${audit.status}</span></td>
                        <td>${formatDate(audit.planDate)}</td>
                        <td>${formatDate(audit.dueDate)}</td>
                        <td>${statusIcons.join(' ')}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editAudit('${audit.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteAudit('${audit.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateSPITable() {
            const tbody = document.getElementById('spiTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.spis.forEach(spi => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${spi.id}</td>
                        <td>${spi.type}</td>
                        <td>${spi.name}</td>
                        <td>${formatDate(spi.date)}</td>
                        <td>${spi.target}</td>
                        <td>${spi.actual}</td>
                        <td><span class="status-${spi.status.toLowerCase()}">${spi.status}</span></td>
                        <td>${spi.comments}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editSPI('${spi.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteSPI('${spi.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateOutstationTable() {
            const tbody = document.getElementById('outstationTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.outstations.forEach(outstation => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${outstation.code}</td>
                        <td>${outstation.name}</td>
                        <td>${outstation.country}</td>
                        <td><span class="status-${outstation.status.toLowerCase().replace(' ', '-')}">${outstation.status}</span></td>
                        <td>${outstation.officer}</td>
                        <td>${formatDate(outstation.auditDate)}</td>
                        <td>${outstation.occurrences}</td>
                        <td>${outstation.auditFindings}</td>
                        <td>${outstation.dgOccurrences}</td>
                        <td>${outstation.hazards}</td>
                        <td>${outstation.comments}</td>
                        <td>${getDocumentCount('outstation', outstation.code)}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editOutstation('${outstation.code}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteOutstation('${outstation.code}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function updateSafetyTable() {
            const tbody = document.getElementById('safetyTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                state.safetyActivities.forEach(activity => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${activity.id}</td>
                        <td>${activity.type}</td>
                        <td>${activity.title}</td>
                        <td>${activity.description}</td>
                        <td>${formatDate(activity.date)}</td>
                        <td>${activity.participants}</td>
                        <td>${activity.location}</td>
                        <td>${activity.outcomes}</td>
                        <td>${getDocumentCount('safety', activity.id)}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editSafety('${activity.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteSafety('${activity.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        // Format Date
        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }

        // Format DateTime
        function formatDateTime(dateTimeString) {
            if (!dateTimeString) return 'N/A';
            const options = { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            return new Date(dateTimeString).toLocaleDateString(undefined, options);
        }

        // Document Management Functions
        function getDocumentCount(type, id) {
            const docs = state.documents[type] || [];
            const count = docs.filter(doc => doc.parentId === id).length;
            return count > 0 ? `${count} file(s)` : 'No files';
        }

        function uploadOccurrenceDocuments() {
            const fileInput = document.getElementById('occurrenceFiles');
            const fileList = document.getElementById('occurrenceDocumentList');
            
            if (fileInput.files.length > 0) {
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const listItem = document.createElement('li');
                    listItem.className = 'document-item';
                    listItem.innerHTML = `
                        <span>${file.name}</span>
                        <div class="document-actions">
                            <button class="btn btn-info btn-sm" onclick="downloadDocument('occurrence', '${file.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="removeDocument(this, 'occurrence', '${file.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    fileList.appendChild(listItem);
                    
                    // Store document reference
                    state.documents.occurrence.push({
                        parentId: document.getElementById('occurrenceId').value,
                        name: file.name,
                        type: file.type,
                        size: file.size
                    });
                }
                alert('Documents uploaded successfully!');
                fileInput.value = '';
            } else {
                alert('Please select files to upload.');
            }
        }

        function uploadSAGDocuments() {
            const fileInput = document.getElementById('sagFiles');
            const fileList = document.getElementById('sagDocumentList');
            
            if (fileInput.files.length > 0) {
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const listItem = document.createElement('li');
                    listItem.className = 'document-item';
                    listItem.innerHTML = `
                        <span>${file.name}</span>
                        <div class="document-actions">
                            <button class="btn btn-info btn-sm" onclick="downloadDocument('sag', '${file.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="removeDocument(this, 'sag', '${file.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    fileList.appendChild(listItem);
                    
                    // Store document reference
                    state.documents.sag.push({
                        parentId: document.getElementById('sagId').value,
                        name: file.name,
                        type: file.type,
                        size: file.size
                    });
                }
                alert('Documents uploaded successfully!');
                fileInput.value = '';
            } else {
                alert('Please select files to upload.');
            }
        }

        function uploadDashboardDocuments() {
            const fileInput = document.getElementById('dashboardFiles');
            const fileList = document.getElementById('dashboardDocumentList');
            
            if (fileInput.files.length > 0) {
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const listItem = document.createElement('li');
                    listItem.className = 'document-item';
                    listItem.innerHTML = `
                        <span>${file.name}</span>
                        <div class="document-actions">
                            <button class="btn btn-info btn-sm" onclick="downloadDocument('dashboard', '${file.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="removeDocument(this, 'dashboard', '${file.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    fileList.appendChild(listItem);
                    
                    // Store document reference
                    state.documents.dashboard.push({
                        parentId: document.getElementById('dashboardId').value,
                        name: file.name,
                        type: file.type,
                        size: file.size
                    });
                }
                alert('Documents uploaded successfully!');
                fileInput.value = '';
            } else {
                alert('Please select files to upload.');
            }
        }

        function uploadMOCDocuments() {
            const fileInput = document.getElementById('mocFiles');
            const fileList = document.getElementById('mocDocumentList');
            
            if (fileInput.files.length > 0) {
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const listItem = document.createElement('li');
                    listItem.className = 'document-item';
                    listItem.innerHTML = `
                        <span>${file.name}</span>
                        <div class="document-actions">
                            <button class="btn btn-info btn-sm" onclick="downloadDocument('moc', '${file.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="removeDocument(this, 'moc', '${file.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    fileList.appendChild(listItem);
                    
                    // Store document reference
                    state.documents.moc.push({
                        parentId: document.getElementById('mocId').value,
                        name: file.name,
                        type: file.type,
                        size: file.size
                    });
                }
                alert('Documents uploaded successfully!');
                fileInput.value = '';
            } else {
                alert('Please select files to upload.');
            }
        }

        function uploadOutstationDocuments() {
            const fileInput = document.getElementById('outstationFiles');
            const fileList = document.getElementById('outstationDocumentList');
            
            if (fileInput.files.length > 0) {
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const listItem = document.createElement('li');
                    listItem.className = 'document-item';
                    listItem.innerHTML = `
                        <span>${file.name}</span>
                        <div class="document-actions">
                            <button class="btn btn-info btn-sm" onclick="downloadDocument('outstation', '${file.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="removeDocument(this, 'outstation', '${file.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    fileList.appendChild(listItem);
                    
                    // Store document reference
                    state.documents.outstation.push({
                        parentId: document.getElementById('outstationCode').value,
                        name: file.name,
                        type: file.type,
                        size: file.size
                    });
                }
                alert('Documents uploaded successfully!');
                fileInput.value = '';
            } else {
                alert('Please select files to upload.');
            }
        }

        function uploadISARPSDocuments() {
            const fileInput = document.getElementById('isarpsFiles');
            const fileList = document.getElementById('isarpsDocumentList');
            
            if (fileInput.files.length > 0) {
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const listItem = document.createElement('li');
                    listItem.className = 'document-item';
                    listItem.innerHTML = `
                        <span>${file.name}</span>
                        <div class="document-actions">
                            <button class="btn btn-info btn-sm" onclick="downloadDocument('isarps', '${file.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="removeDocument(this, 'isarps', '${file.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    fileList.appendChild(listItem);
                    
                    // Store document reference
                    state.documents.isarps.push({
                        parentId: document.getElementById('isarpsId').value,
                        name: file.name,
                        type: file.type,
                        size: file.size
                    });
                }
                alert('Documents uploaded successfully!');
                fileInput.value = '';
            } else {
                alert('Please select files to upload.');
            }
        }

        function uploadSafetyDocuments() {
            const fileInput = document.getElementById('safetyFiles');
            const fileList = document.getElementById('safetyDocumentList');
            
            if (fileInput.files.length > 0) {
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const listItem = document.createElement('li');
                    listItem.className = 'document-item';
                    listItem.innerHTML = `
                        <span>${file.name}</span>
                        <div class="document-actions">
                            <button class="btn btn-info btn-sm" onclick="downloadDocument('safety', '${file.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="removeDocument(this, 'safety', '${file.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    fileList.appendChild(listItem);
                    
                    // Store document reference
                    state.documents.safety.push({
                        parentId: document.getElementById('safetyId').value,
                        name: file.name,
                        type: file.type,
                        size: file.size
                    });
                }
                alert('Documents uploaded successfully!');
                fileInput.value = '';
            } else {
                alert('Please select files to upload.');
            }
        }

        function downloadDocument(type, fileName) {
            alert(`Downloading ${fileName} from ${type} section. In a real application, this would download the actual file.`);
        }

        function removeDocument(element, type, fileName) {
            if (confirm(`Are you sure you want to remove ${fileName}?`)) {
                // Remove from UI
                element.closest('.document-item').remove();
                
                // Remove from state
                state.documents[type] = state.documents[type].filter(doc => doc.name !== fileName);
            }
        }

        // Risk Assessment Bulk Upload Functions
        function previewRiskData() {
            const fileInput = document.getElementById('riskUploadFile');
            if (!fileInput.files.length) {
                alert('Please select an Excel file to preview.');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                
                // Display preview
                const previewBody = document.getElementById('riskPreviewBody');
                previewBody.innerHTML = '';
                
                jsonData.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${row['Risk ID'] || ''}</td>
                        <td>${row['Category'] || ''}</td>
                        <td>${row['Hazard'] || ''}</td>
                        <td>${row['Top Event'] || ''}</td>
                        <td>${row['Threats'] || ''}</td>
                        <td>${row['Consequences'] || ''}</td>
                        <td>${row['Preventive Barriers'] || ''}</td>
                        <td>${row['Recovery Barriers'] || ''}</td>
                        <td>${row['Likelihood'] || ''}</td>
                        <td>${row['Severity'] || ''}</td>
                        <td>${row['Risk Level'] || ''}</td>
                        <td>${row['Responsible'] || ''}</td>
                        <td>${row['Due Date'] || ''}</td>
                        <td>${row['Date Identified'] || ''}</td>
                        <td>${row['Control Effectiveness'] || ''}</td>
                        <td>${row['Risk Owner'] || ''}</td>
                    `;
                    previewBody.appendChild(tr);
                });
                
                // Show preview section
                document.getElementById('riskPreview').style.display = 'block';
            };
            
            reader.readAsArrayBuffer(file);
        }

        function uploadRiskData() {
            const fileInput = document.getElementById('riskUploadFile');
            if (!fileInput.files.length) {
                alert('Please select an Excel file to upload.');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                
                // Process and add data to state
                jsonData.forEach(row => {
                    const newRisk = {
                        id: row['Risk ID'],
                        category: row['Category'],
                        hazard: row['Hazard'],
                        topEvent: row['Top Event'],
                        threats: row['Threats'],
                        consequences: row['Consequences'],
                        preventiveBarriers: row['Preventive Barriers'],
                        recoveryBarriers: row['Recovery Barriers'],
                        likelihood: row['Likelihood'],
                        severity: row['Severity'],
                        level: row['Risk Level'],
                        responsible: row['Responsible'],
                        dueDate: row['Due Date'],
                        dateIdentified: row['Date Identified'],
                        controlEffectiveness: row['Control Effectiveness'],
                        riskOwner: row['Risk Owner']
                    };
                    
                    state.risks.push(newRisk);
                });
                
                // Update UI
                updateRiskTable();
                alert('Risk data uploaded successfully!');
                
                // Reset form and hide preview
                fileInput.value = '';
                document.getElementById('riskPreview').style.display = 'none';
            };
            
            reader.readAsArrayBuffer(file);
        }

        function confirmRiskUpload() {
            uploadRiskData();
        }

        function cancelRiskUpload() {
            document.getElementById('riskPreview').style.display = 'none';
            document.getElementById('riskUploadFile').value = '';
        }

        // Form Submissions
        document.getElementById('riskForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const riskId = document.getElementById('riskId').value;
            const category = document.getElementById('riskCategory').value;
            const hazard = document.getElementById('riskHazard').value;
            const topEvent = document.getElementById('riskTopEvent').value;
            const threats = document.getElementById('riskThreats').value;
            const consequences = document.getElementById('riskConsequences').value;
            const preventiveBarriers = document.getElementById('riskPreventiveBarriers').value;
            const recoveryBarriers = document.getElementById('riskRecoveryBarriers').value;
            const likelihood = document.getElementById('riskLikelihood').value;
            const severity = document.getElementById('riskSeverity').value;
            const level = document.getElementById('riskLevel').value;
            const responsible = document.getElementById('riskResponsible').value;
            const dueDate = document.getElementById('riskDueDate').value;
            const dateIdentified = document.getElementById('riskDateIdentified').value;
            const controlEffectiveness = document.getElementById('riskControlEffectiveness').value;
            const riskOwner = document.getElementById('riskOwner').value;
            
            // Create new risk object
            const newRisk = {
                id: riskId,
                category: category,
                hazard: hazard,
                topEvent: topEvent,
                threats: threats,
                consequences: consequences,
                preventiveBarriers: preventiveBarriers,
                recoveryBarriers: recoveryBarriers,
                likelihood: likelihood,
                severity: severity,
                level: level,
                responsible: responsible,
                dueDate: dueDate,
                dateIdentified: dateIdentified,
                controlEffectiveness: controlEffectiveness,
                riskOwner: riskOwner
            };
            
            // Add to state
            state.risks.push(newRisk);
            
            // Update UI
            updateRiskTable();
            
            alert('Risk assessment saved successfully!');
            this.reset();
        });

        document.getElementById('evidenceForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const evidenceId = document.getElementById('evidenceId').value;
            const isarpsRef = document.getElementById('evidenceIsarps').value;
            const description = document.getElementById('evidenceDesc').value;
            const date = document.getElementById('evidenceDate').value;
            const status = document.getElementById('evidenceStatus').value;
            const comments = document.getElementById('evidenceComments').value;
            
            // Create new evidence object
            const newEvidence = {
                id: evidenceId,
                isarpsRef: isarpsRef,
                description: description,
                date: date,
                status: status,
                comments: comments
            };
            
            // Add to state
            state.evidences.push(newEvidence);
            
            // Update UI
            updateEvidenceTable();
            
            alert('Evidence saved successfully!');
            this.reset();
        });

        document.getElementById('occurrenceForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const occurrenceId = document.getElementById('occurrenceId').value;
            const dateTime = document.getElementById('occurrenceDateTime').value;
            const type = document.getElementById('occurrenceType').value;
            const severity = document.getElementById('occurrenceSeverity').value;
            const description = document.getElementById('occurrenceDesc').value;
            const location = document.getElementById('occurrenceLocation').value;
            const flightNo = document.getElementById('occurrenceFlight').value;
            const actions = document.getElementById('occurrenceActions').value;
            
            // Create new occurrence object
            const newOccurrence = {
                id: occurrenceId,
                dateTime: dateTime,
                type: type,
                severity: severity,
                description: description,
                location: location,
                flightNo: flightNo,
                actions: actions
            };
            
            // Add to state
            state.occurrences.push(newOccurrence);
            
            // Update UI
            updateOccurrenceTable();
            
            alert('Occurrence saved successfully!');
            this.reset();
        });

        document.getElementById('sagForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const sagId = document.getElementById('sagId').value;
            const date = document.getElementById('sagDate').value;
            const type = document.getElementById('sagType').value;
            const chairperson = document.getElementById('sagChairperson').value;
            const attendance = document.getElementById('sagAttendance').value;
            const agenda = document.getElementById('sagAgenda').value;
            const actions = document.getElementById('sagActions').value;
            const nextDate = document.getElementById('sagNextDate').value;
            
            // Create new SAG object
            const newSAG = {
                id: sagId,
                date: date,
                type: type,
                chairperson: chairperson,
                attendance: attendance,
                agenda: agenda,
                actions: actions,
                nextDate: nextDate
            };
            
            // Add to state
            state.sagMeetings.push(newSAG);
            
            // Update UI
            updateSAGTable();
            
            alert('SAG meeting saved successfully!');
            this.reset();
        });

        document.getElementById('dashboardForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const dashboardId = document.getElementById('dashboardId').value;
            const type = document.getElementById('dashboardType').value;
            const month = document.getElementById('dashboardMonth').value;
            const year = document.getElementById('dashboardYear').value;
            const safetyPerformance = document.getElementById('dashboardSafety').value;
            const qualityPerformance = document.getElementById('dashboardQuality').value;
            const overallScore = document.getElementById('dashboardOverall').value;
            const comments = document.getElementById('dashboardComments').value;
            
            // Create new dashboard object
            const newDashboard = {
                id: dashboardId,
                type: type,
                month: month,
                year: year,
                safetyPerformance: safetyPerformance,
                qualityPerformance: qualityPerformance,
                overallScore: overallScore,
                comments: comments
            };
            
            // Add to state
            state.dashboards.push(newDashboard);
            
            // Update UI
            updateDashboardTable();
            
            alert('Dashboard data saved successfully!');
            this.reset();
        });

        document.getElementById('mocForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const mocId = document.getElementById('mocId').value;
            const type = document.getElementById('mocType').value;
            const description = document.getElementById('mocDesc').value;
            const requestedBy = document.getElementById('mocRequestedBy').value;
            const requestDate = document.getElementById('mocRequestDate').value;
            const riskAssessment = document.getElementById('mocRiskAssessment').value;
            const status = document.getElementById('mocStatus').value;
            const comments = document.getElementById('mocComments').value;
            
            // Create new MOC object
            const newMOC = {
                id: mocId,
                type: type,
                description: description,
                requestedBy: requestedBy,
                requestDate: requestDate,
                riskAssessment: riskAssessment,
                status: status,
                comments: comments
            };
            
            // Add to state
            state.mocRecords.push(newMOC);
            
            // Update UI
            updateMOCTable();
            
            alert('MOC record saved successfully!');
            this.reset();
        });

        document.getElementById('auditForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const auditId = document.getElementById('auditId').value;
            const type = document.getElementById('auditType').value;
            const date = document.getElementById('auditDate').value;
            const auditor = document.getElementById('auditAuditor').value;
            const area = document.getElementById('auditArea').value;
            const findings = document.getElementById('auditFindings').value;
            const status = document.getElementById('auditStatus').value;
            const planDate = document.getElementById('auditPlanDate').value;
            const dueDate = document.getElementById('auditDueDate').value;
            const capaReceived = document.getElementById('auditCAPAReceived').checked;
            const rccaDone = document.getElementById('auditRCCADone').checked;
            const implementationEvidenceReceived = document.getElementById('auditImplementationEvidenceReceived').checked;
            
            // Create new audit object
            const newAudit = {
                id: auditId,
                type: type,
                date: date,
                auditor: auditor,
                area: area,
                findings: findings,
                status: status,
                planDate: planDate,
                dueDate: dueDate,
                capaReceived: capaReceived,
                rccaDone: rccaDone,
                implementationEvidenceReceived: implementationEvidenceReceived
            };
            
            // Add to state
            state.audits.push(newAudit);
            
            // Update UI
            updateAuditTable();
            
            alert('Audit saved successfully!');
            this.reset();
        });

        document.getElementById('spiForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const spiId = document.getElementById('spiId').value;
            const type = document.getElementById('spiType').value;
            const name = document.getElementById('spiName').value;
            const date = document.getElementById('spiDate').value;
            const target = document.getElementById('spiTarget').value;
            const actual = document.getElementById('spiActual').value;
            const status = document.getElementById('spiStatus').value;
            const comments = document.getElementById('spiComments').value;
            
            // Create new SPI object
            const newSPI = {
                id: spiId,
                type: type,
                name: name,
                date: date,
                target: target,
                actual: actual,
                status: status,
                comments: comments
            };
            
            // Add to state
            state.spis.push(newSPI);
            
            // Update UI
            updateSPITable();
            
            alert('SPI data saved successfully!');
            this.reset();
        });

        document.getElementById('outstationForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const code = document.getElementById('outstationCode').value;
            const name = document.getElementById('outstationName').value;
            const country = document.getElementById('outstationCountry').value;
            const status = document.getElementById('outstationStatus').value;
            const officer = document.getElementById('outstationOfficer').value;
            const auditDate = document.getElementById('outstationAuditDate').value;
            const occurrences = document.getElementById('outstationOccurrences').value;
            const auditFindings = document.getElementById('outstationAuditFindings').value;
            const dgOccurrences = document.getElementById('outstationDGOccurrences').value;
            const hazards = document.getElementById('outstationHazards').value;
            const comments = document.getElementById('outstationComments').value;
            
            // Create new outstation object
            const newOutstation = {
                code: code,
                name: name,
                country: country,
                status: status,
                officer: officer,
                auditDate: auditDate,
                occurrences: occurrences,
                auditFindings: auditFindings,
                dgOccurrences: dgOccurrences,
                hazards: hazards,
                comments: comments
            };
            
            // Add to state
            state.outstations.push(newOutstation);
            
            // Update UI
            updateOutstationTable();
            
            alert('Outstation saved successfully!');
            this.reset();
        });

        document.getElementById('isarpsForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const isarpsId = document.getElementById('isarpsId').value;
            const title = document.getElementById('isarpsTitle').value;
            const description = document.getElementById('isarpsDesc').value;
            const manualRef = document.getElementById('isarpsManualRef').value;
            const manualLink = document.getElementById('isarpsManualLink').value;
            const status = document.getElementById('isarpsStatus').value;
            const dueDate = document.getElementById('isarpsDueDate').value;
            const risk = document.getElementById('isarpsRisk').value;
            const responsible = document.getElementById('isarpsResponsible').value;
            
            // Create new ISARPS object
            const newISARPS = {
                id: isarpsId,
                title: title,
                description: description,
                manualRef: manualRef,
                manualLink: manualLink,
                status: status,
                dueDate: dueDate,
                risk: risk,
                responsible: responsible
            };
            
            // Add to state
            state.isarps.push(newISARPS);
            
            // Update UI
            updateISARPSTable();
            updateDashboard();
            
            alert('ISARPS saved successfully!');
            this.reset();
        });

        document.getElementById('safetyForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const safetyId = document.getElementById('safetyId').value;
            const type = document.getElementById('safetyType').value;
            const title = document.getElementById('safetyTitle').value;
            const description = document.getElementById('safetyDesc').value;
            const date = document.getElementById('safetyDate').value;
            const participants = document.getElementById('safetyParticipants').value;
            const location = document.getElementById('safetyLocation').value;
            const outcomes = document.getElementById('safetyOutcomes').value;
            
            // Create new safety activity object
            const newSafety = {
                id: safetyId,
                type: type,
                title: title,
                description: description,
                date: date,
                participants: participants,
                location: location,
                outcomes: outcomes
            };
            
            // Add to state
            state.safetyActivities.push(newSafety);
            
            // Update UI
            updateSafetyTable();
            
            alert('Safety activity saved successfully!');
            this.reset();
        });

        // Search Functions
        function searchRiskData() {
            const category = document.getElementById('riskSearchCategory').value;
            const level = document.getElementById('riskSearchLevel').value;
            const fromDate = document.getElementById('riskSearchFrom').value;
            const toDate = document.getElementById('riskSearchTo').value;
            
            alert(`Searching risk data with filters:\nCategory: ${category || 'All'}\nRisk Level: ${level || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetRiskSearch() {
            document.getElementById('riskSearchForm').reset();
        }

        function searchEvidenceData() {
            const isarpsRef = document.getElementById('evidenceSearchIsarps').value;
            const status = document.getElementById('evidenceSearchStatus').value;
            const fromDate = document.getElementById('evidenceSearchFrom').value;
            const toDate = document.getElementById('evidenceSearchTo').value;
            
            alert(`Searching evidence data with filters:\nISARPS: ${isarpsRef || 'All'}\nStatus: ${status || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetEvidenceSearch() {
            document.getElementById('evidenceSearchForm').reset();
        }

        function searchOccurrenceData() {
            const type = document.getElementById('occurrenceSearchType').value;
            const severity = document.getElementById('occurrenceSearchSeverity').value;
            const fromDate = document.getElementById('occurrenceSearchFrom').value;
            const toDate = document.getElementById('occurrenceSearchTo').value;
            
            alert(`Searching occurrence data with filters:\nType: ${type || 'All'}\nSeverity: ${severity || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetOccurrenceSearch() {
            document.getElementById('occurrenceSearchForm').reset();
        }

        function searchSAGData() {
            const type = document.getElementById('sagSearchType').value;
            const fromDate = document.getElementById('sagSearchFrom').value;
            const toDate = document.getElementById('sagSearchTo').value;
            
            alert(`Searching SAG data with filters:\nType: ${type || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetSAGSearch() {
            document.getElementById('sagSearchForm').reset();
        }

        function searchDashboardData() {
            const type = document.getElementById('dashboardSearchType').value;
            const month = document.getElementById('dashboardSearchMonth').value;
            const year = document.getElementById('dashboardSearchYear').value;
            
            alert(`Searching dashboard data with filters:\nType: ${type || 'All'}\nMonth: ${month || 'All'}\nYear: ${year || 'Any'}`);
        }

        function resetDashboardSearch() {
            document.getElementById('dashboardSearchForm').reset();
        }

        function searchMOCData() {
            const type = document.getElementById('mocSearchType').value;
            const status = document.getElementById('mocSearchStatus').value;
            const fromDate = document.getElementById('mocSearchFrom').value;
            const toDate = document.getElementById('mocSearchTo').value;
            
            alert(`Searching MOC data with filters:\nType: ${type || 'All'}\nStatus: ${status || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetMOCSearch() {
            document.getElementById('mocSearchForm').reset();
        }

        function searchAuditData() {
            const type = document.getElementById('auditSearchType').value;
            const status = document.getElementById('auditSearchStatus').value;
            const fromDate = document.getElementById('auditSearchFrom').value;
            const toDate = document.getElementById('auditSearchTo').value;
            
            alert(`Searching audit data with filters:\nType: ${type || 'All'}\nStatus: ${status || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetAuditSearch() {
            document.getElementById('auditSearchForm').reset();
        }

        function searchSPIData() {
            const type = document.getElementById('spiSearchType').value;
            const status = document.getElementById('spiSearchStatus').value;
            const fromDate = document.getElementById('spiSearchFrom').value;
            const toDate = document.getElementById('spiSearchTo').value;
            
            alert(`Searching SPI data with filters:\nType: ${type || 'All'}\nStatus: ${status || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetSPISearch() {
            document.getElementById('spiSearchForm').reset();
        }

        function searchOutstationData() {
            const station = document.getElementById('outstationSearchStation').value;
            const status = document.getElementById('outstationSearchStatus').value;
            
            alert(`Searching outstation data with filters:\nStation: ${station || 'All'}\nStatus: ${status || 'All'}`);
        }

        function resetOutstationSearch() {
            document.getElementById('outstationSearchForm').reset();
        }

        function searchISARPSData() {
            const status = document.getElementById('isarpsSearchStatus').value;
            const risk = document.getElementById('isarpsSearchRisk').value;
            const fromDate = document.getElementById('isarpsSearchFrom').value;
            const toDate = document.getElementById('isarpsSearchTo').value;
            
            alert(`Searching ISARPS data with filters:\nStatus: ${status || 'All'}\nRisk Level: ${risk || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetISARPSSearch() {
            document.getElementById('isarpsSearchForm').reset();
        }

        function searchSafetyData() {
            const type = document.getElementById('safetySearchType').value;
            const fromDate = document.getElementById('safetySearchFrom').value;
            const toDate = document.getElementById('safetySearchTo').value;
            
            alert(`Searching safety data with filters:\nType: ${type || 'All'}\nFrom: ${fromDate || 'Any'}\nTo: ${toDate || 'Any'}`);
        }

        function resetSafetySearch() {
            document.getElementById('safetySearchForm').reset();
        }

        // Placeholder functions for edit and delete operations
        function editISARPS(id) {
            alert(`Edit ISARPS: ${id} - This would open an edit form in a real application.`);
        }

        function deleteISARPS(id) {
            if (confirm(`Are you sure you want to delete ISARPS ${id}?`)) {
                state.isarps = state.isarps.filter(item => item.id !== id);
                updateISARPSTable();
                updateDashboard();
            }
        }

        function editRisk(id) {
            alert(`Edit Risk: ${id} - This would open an edit form in a real application.`);
        }

        function deleteRisk(id) {
            if (confirm(`Are you sure you want to delete Risk ${id}?`)) {
                state.risks = state.risks.filter(item => item.id !== id);
                updateRiskTable();
            }
        }

        function editEvidence(id) {
            alert(`Edit Evidence: ${id} - This would open an edit form in a real application.`);
        }

        function deleteEvidence(id) {
            if (confirm(`Are you sure you want to delete Evidence ${id}?`)) {
                state.evidences = state.evidences.filter(item => item.id !== id);
                updateEvidenceTable();
            }
        }

        function editOccurrence(id) {
            alert(`Edit Occurrence: ${id} - This would open an edit form in a real application.`);
        }

        function deleteOccurrence(id) {
            if (confirm(`Are you sure you want to delete Occurrence ${id}?`)) {
                state.occurrences = state.occurrences.filter(item => item.id !== id);
                updateOccurrenceTable();
            }
        }

        function editSAG(id) {
            alert(`Edit SAG: ${id} - This would open an edit form in a real application.`);
        }

        function deleteSAG(id) {
            if (confirm(`Are you sure you want to delete SAG ${id}?`)) {
                state.sagMeetings = state.sagMeetings.filter(item => item.id !== id);
                updateSAGTable();
            }
        }

        function editDashboard(id) {
            alert(`Edit Dashboard: ${id} - This would open an edit form in a real application.`);
        }

        function deleteDashboard(id) {
            if (confirm(`Are you sure you want to delete Dashboard ${id}?`)) {
                state.dashboards = state.dashboards.filter(item => item.id !== id);
                updateDashboardTable();
            }
        }

        function editMOC(id) {
            alert(`Edit MOC: ${id} - This would open an edit form in a real application.`);
        }

        function deleteMOC(id) {
            if (confirm(`Are you sure you want to delete MOC ${id}?`)) {
                state.mocRecords = state.mocRecords.filter(item => item.id !== id);
                updateMOCTable();
            }
        }

        function editAudit(id) {
            alert(`Edit Audit: ${id} - This would open an edit form in a real application.`);
        }

        function deleteAudit(id) {
            if (confirm(`Are you sure you want to delete Audit ${id}?`)) {
                state.audits = state.audits.filter(item => item.id !== id);
                updateAuditTable();
            }
        }

        function editSPI(id) {
            alert(`Edit SPI: ${id} - This would open an edit form in a real application.`);
        }

        function deleteSPI(id) {
            if (confirm(`Are you sure you want to delete SPI ${id}?`)) {
                state.spis = state.spis.filter(item => item.id !== id);
                updateSPITable();
            }
        }

        function editOutstation(code) {
            alert(`Edit Outstation: ${code} - This would open an edit form in a real application.`);
        }

        function deleteOutstation(code) {
            if (confirm(`Are you sure you want to delete Outstation ${code}?`)) {
                state.outstations = state.outstations.filter(item => item.code !== code);
                updateOutstationTable();
            }
        }

        function editSafety(id) {
            alert(`Edit Safety Activity: ${id} - This would open an edit form in a real application.`);
        }

        function deleteSafety(id) {
            if (confirm(`Are you sure you want to delete Safety Activity ${id}?`)) {
                state.safetyActivities = state.safetyActivities.filter(item => item.id !== id);
                updateSafetyTable();
            }
        }

        // Initialize the application
        window.onload = function() {
            // Initialize any required functionality
        };
    </script>
</body>
</html>